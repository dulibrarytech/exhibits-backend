let itemsCommonGridItemFormModule=(()=>{let a=endpointsModule.get_exhibits_endpoints();var e={get_common_grid_item_form_fields:function(){try{var e=[],t={styles:{}};if(t.title=document.querySelector("#item-title-input").value,t.text=document.querySelector("#item-text-input").value,t.description=document.querySelector("#item-description-input").value,t.caption=document.querySelector("#item-caption-input").value,-1!==window.location.pathname.indexOf("text")&&0===t.text.length)return!(document.querySelector("#message").innerHTML='<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> Please enter "Text" for this item</div>');if(null!==document.querySelector("#is-published")&&(t.is_published=document.querySelector("#is-published").value),-1!==window.location.pathname.indexOf("media")){if(t.is_alt_text_decorative=document.querySelector("#is-alt-text-decorative").checked,t.is_embedded=document.querySelector("#embed-item").checked,!0===t.is_embedded?t.is_embedded=1:!1===t.is_embedded&&(t.is_embedded=0),t.thumbnail=document.querySelector("#item-thumbnail").value,t.thumbnail_prev=document.querySelector("#item-thumbnail-image-prev").value,t.item_type=document.querySelector("#item-type").value,t.mime_type=document.querySelector("#item-mime-type").value,t.media=document.querySelector("#item-media").value,t.media_prev=document.querySelector("#item-media-prev").value,t.kaltura=document.querySelector("#audio-video").value,t.repo_uuid=document.querySelector("#repo-uuid").value,t.pdf_open_to_page=document.querySelector("#pdf-open-to-page").value,-1!==t.mime_type.indexOf("image"))if(!0===t.is_alt_text_decorative)t.is_alt_text_decorative=1,t.alt_text="";else if(!1===t.is_alt_text_decorative&&(t.is_alt_text_decorative=0,t.alt_text=document.querySelector("#item-alt-text-input").value,0===t.alt_text.length)&&0===t.alt_text.length&&0===t.alt_text.length)return!(document.querySelector("#message").innerHTML='<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> Please enter "alt text" for this item</div>');if(0===t.media.length&&0===t.kaltura.length&&0===t.repo_uuid.length&&0===t.text.length)return!(document.querySelector("#message").innerHTML='<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> Please upload or import a media item</div>');if(0<t.media.length&&0<t.repo_uuid.length&&t.media===t.repo_uuid&&(t.repo_uuid=""),0<t.media.length&&0<t.kaltura.length&&t.media===t.kaltura&&(t.kaltura=""),0<t.media.length&&e.push(t.media),0<t.kaltura.length&&(e.push(t.kaltura),t.item_type="kaltura"),0<t.repo_uuid.length&&e.push(t.repo_uuid),1<e.length)return!(document.querySelector("#message").innerHTML='<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> Please upload or import only one media item</div>');"kaltura"===t.item_type&&(t.item_type=document.querySelector('input[name="item_type"]:checked').value)}else t.item_type="text";t.layout=helperModule.get_checked_radio_button(document.getElementsByName("layout")),t.media_width=helperModule.get_checked_radio_button(document.getElementsByName("media_width"));var a=document.querySelector("#item-background-color").value,l=document.querySelector("#item-font-color").value,i=document.querySelector("#item-font").value,o=document.querySelector("#item-font-size").value;return 0<a.length&&(t.styles.backgroundColor=a),0<l.length&&(t.styles.color=document.querySelector("#item-font-color").value),0<i.length&&(t.styles.fontFamily=i),0<o.length&&(t.styles.fontSize=o+"px"),t}catch(e){document.querySelector("#message").innerHTML=`<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> ${e.message}</div>`}}};return e.delete_media=function(){try{(async()=>{var e=document.querySelector("#item-media").value,t=authModule.get_user_token();void 0!==(e=await httpModule.req({method:"DELETE",url:a.exhibits.media.delete.endpoint+"?media="+e,headers:{"Content-Type":"application/json","x-access-token":t}}))&&204===e.status&&(document.querySelector("#item-media").value="",document.querySelector("#item-media-thumbnail-image-display").innerHTML="",document.querySelector("#item-media-filename-display").innerHTML="",document.querySelector("#item-media-trash").style.display="none",document.querySelector("#message").innerHTML='<div class="alert alert-success" role="alert"><i class="fa fa-info"></i> Media deleted</div>',document.querySelector("#toggle-open-to-page").style.visibility="hidden",document.querySelector("#image-alt-text").style.display="none",setTimeout(()=>{document.querySelector("#message").innerHTML=""},3e3))})()}catch(e){document.querySelector("#message").innerHTML=`<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> ${e.message}</div>`}return!1},e.delete_thumbnail_image=function(){try{(async()=>{var e=document.querySelector("#item-thumbnail").value,t=authModule.get_user_token();void 0!==(e=await httpModule.req({method:"DELETE",url:a.exhibits.media.delete.endpoint+"?media="+e,headers:{"Content-Type":"application/json","x-access-token":t}}))&&204===e.status&&(document.querySelector("#item-thumbnail").value="",document.querySelector("#item-thumbnail-image-display").innerHTML="",document.querySelector("#item-thumbnail-filename-display").innerHTML="",document.querySelector("#item-thumbnail-trash").style.display="none",document.querySelector("#item-media-thumbnail-image-display").innerHTML="",document.querySelector("#message").innerHTML='<div class="alert alert-success" role="alert"><i class="fa fa-info"></i> Thumbnail image deleted</div>',setTimeout(()=>{document.querySelector("#message").innerHTML=""},3e3))})()}catch(e){document.querySelector("#message").innerHTML=`<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> ${e.message}</div>`}return!1},e.init=async function(){try{-1!==window.location.pathname.indexOf("media")&&(uploadsModule.upload_item_media(),uploadsModule.upload_item_thumbnail(),document.querySelector("#item-media-trash").style.display="none",document.querySelector("#item-thumbnail-trash").style.display="none",document.querySelector("#is-media-only-caption").style.display="block",setTimeout(()=>{document.querySelector("#item-media-trash").addEventListener("click",itemsCommonGridItemFormModule.delete_media),document.querySelector("#item-thumbnail-trash").addEventListener("click",itemsCommonGridItemFormModule.delete_thumbnail_image)},1e3),document.querySelector("#repo-uuid-btn").addEventListener("click",async()=>{await helperModule.get_repo_item_data(null)}),document.querySelector("#audio-video").addEventListener("focusout",()=>{helperModule.clear_media_fields("kaltura_media"),document.querySelector("#is-kaltura-item").value=1})),-1!==window.location.pathname.indexOf("text")&&(document.querySelector("#is-required-text").innerHTML='<span style="color: darkred">*</span> Text<small><em>(Required)</em></small>');var e=authModule.get_user_token();await authModule.check_auth(e),navModule.init(),navModule.back_to_grid_items(),navModule.set_preview_link(),document.querySelector("#item-background-color-picker").addEventListener("input",()=>{document.querySelector("#item-background-color")&&(document.querySelector("#item-background-color").value=document.querySelector("#item-background-color-picker").value)}),document.querySelector("#item-background-color").addEventListener("input",()=>{document.querySelector("#item-background-color-picker").value=document.querySelector("#item-background-color").value}),document.querySelector("#item-font-color-picker").addEventListener("input",()=>{document.querySelector("#item-font-color")&&(document.querySelector("#item-font-color").value=document.querySelector("#item-font-color-picker").value)}),document.querySelector("#item-font-color").addEventListener("input",()=>{document.querySelector("#item-font-color-picker").value=document.querySelector("#item-font-color").value}),helperModule.show_form()}catch(e){document.querySelector("#message").innerHTML=`<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> ${e.message}</div>`}},e})();