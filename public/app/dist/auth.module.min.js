let authModule=(()=>{let o=window.localStorage.getItem("exhibits_app_path"),a=endpointsModule.init();var e={get_user_token:function(){var e=JSON.parse(window.sessionStorage.getItem("exhibits_token"));if(null===e||null!==e.token)return null!==e&&DOMPurify.sanitize(e.token);window.location.replace(o+"/")},get_auth_user_data:async function(){var e=helperModule.get_parameter_by_name("id");if(null!==e){authModule.save_token();var t=authModule.get_user_token(),e=a.authenticate+"?id="+e,e=await httpModule.req({method:"GET",url:e,headers:{"Content-Type":"application/json","x-access-token":t}});if(200===e.status)return authModule.save_user_auth_data(e.data),!0;authModule.redirect_to_auth()}},get_user_profile_data:function(){var e=window.sessionStorage.getItem("exhibits_user");if(null!==e)return JSON.parse(e);authModule.redirect_to_auth()},check_user_auth_data:function(){return null!==window.sessionStorage.getItem("exhibits_user")},save_user_auth_data:function(e){var t={uid:DOMPurify.sanitize(e.user_data.data[0].id),name:DOMPurify.sanitize(e.user_data.data[0].first_name)+" "+DOMPurify.sanitize(e.user_data.data[0].last_name)};endpointsModule.save_exhibits_endpoints(e),window.sessionStorage.setItem("exhibits_user",JSON.stringify(t))},save_token:function(){var e=helperModule.get_parameter_by_name("t");null!==e&&(e={token:DOMPurify.sanitize(e)},window.sessionStorage.setItem("exhibits_token",JSON.stringify(e)))},check_auth:async function(e){try{if(!1===e)return document.querySelector("#message").innerHTML='<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> Session Expired. One moment please...</div>',authModule.redirect_to_auth(),!1;var t=endpointsModule.get_exhibits_endpoints();void 0===await httpModule.req({method:"POST",url:t.exhibits.token_verify.endpoint,headers:{"Content-Type":"application/json","x-access-token":e}})&&window.location.replace(o+"/session")}catch(e){document.querySelector("#message").innerHTML=`<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> ${e.message}</div>`}},check_permissions:async function(e,t,a){try{var i=authModule.get_user_token();if(!1===i)return document.querySelector("#message").innerHTML='<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> Session Expired. One moment please...</div>',authModule.redirect_to_auth(),!1;var n={permissions:e,record_type:t,uuid:a};void 0===await httpModule.req({method:"POST",url:"/exhibits-dashboard/auth/permissions",headers:{"Content-Type":"application/json","x-access-token":i},data:n})&&window.location.replace(o+"/access-denied")}catch(e){console.log("ERROR ",e),document.querySelector("#message").innerHTML=`<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> ${e.message}</div>`}},redirect_to_auth:function(){setTimeout(()=>{window.location.replace(o+"/auth")},4e3)},clear:function(){window.sessionStorage.clear(),window.localStorage.clear()},logout:function(){window.location.replace(o+"/logout")},init:function(){}};return e})();