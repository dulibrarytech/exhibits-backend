let itemsEditTimelineItemFormModule=(()=>{let m=window.localStorage.getItem("exhibits_app_path"),c=endpointsModule.get_exhibits_endpoints();var e={};async function t(){try{var t=await(async()=>{try{var e,t=helperModule.get_parameter_by_name("exhibit_id"),a=helperModule.get_parameter_by_name("timeline_id"),i=helperModule.get_parameter_by_name("item_id"),r=authModule.get_user_token(),l=c.exhibits.timeline_item_record.get.endpoint.replace(":exhibit_id",t).replace(":timeline_id",a).replace(":item_id",i);return!1===r?(document.querySelector("#message").innerHTML="ERROR: Unable to get API endpoints",setTimeout(()=>{window.location.replace(m+"/exhibits-dashboard/auth")},1e3),!1):void 0!==(e=await httpModule.req({method:"GET",url:l,headers:{"Content-Type":"application/json","x-access-token":r}}))&&200===e.status?e.data.data[0]:void 0}catch(e){document.querySelector("#message").innerHTML=`<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> ${e.message}</div>`}})(),a=t.created_by,i=new Date(t.created),r=t.updated_by,l=t.updated,n=new Date(l);let e="";var o=helperModule.format_date(i),d=helperModule.format_date(n),s=(null!==a&&(e+=`<em>Created by ${a} on ${o}</em>`),null!==r&&(e+=` | <em>Last updated by ${r} on ${d}</em>`),document.querySelector("#created").innerHTML=e,document.querySelector("#item-title-input").value=helperModule.unescape(t.title),document.querySelector("#item-text-input").value=helperModule.unescape(t.text),-1!==window.location.pathname.indexOf("media")&&helperMediaModule.display_media_fields_common(t),t.date.split("T"));return document.querySelector("#item-date-input").value=s.shift(),!1}catch(e){document.querySelector("#message").innerHTML=`<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> ${e.message}</div>`}}return e.update_timeline_item_record=async function(){try{window.scrollTo(0,0);var e=helperModule.get_parameter_by_name("exhibit_id"),t=helperModule.get_parameter_by_name("timeline_id"),a=helperModule.get_parameter_by_name("item_id");if(void 0===e||void 0===t||void 0===a)return!(document.querySelector("#message").innerHTML='<div class="alert alert-warning" role="alert"><i class="fa fa-info"></i> Unable to update timeline item record.</div>');document.querySelector("#message").innerHTML='<div class="alert alert-info" role="alert"><i class="fa fa-info"></i> Updating timeline item record...</div>';var i=itemsCommonVerticalTimelineItemFormModule.get_common_timeline_item_form_fields();if(void 0===i)return!(document.querySelector("#message").innerHTML='<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> Unable to get form field values</div>');if(!1===i)return!1;var r=JSON.parse(sessionStorage.getItem("exhibits_user"));if(null===r.name)return!(document.querySelector("#message").innerHTML='<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> Unable to retrieve your name</div>');i.updated_by=r.name;var l=c.exhibits.timeline_item_records.put.endpoint.replace(":exhibit_id",e).replace(":timeline_id",t).replace(":item_id",a),n=authModule.get_user_token(),o=await httpModule.req({method:"PUT",url:l,data:i,headers:{"Content-Type":"application/json","x-access-token":n}});void 0!==o&&201===o.status&&(document.querySelector("#message").innerHTML='<div class="alert alert-success" role="alert"><i class="fa fa-info"></i> Timeline item record updated</div>',setTimeout(()=>{window.location.reload()},900))}catch(e){document.querySelector("#message").innerHTML=`<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> ${e.message}</div>`}},e.init=async function(){try{var e=helperModule.get_parameter_by_name("exhibit_id");exhibitsModule.set_exhibit_title(e),navModule.set_timeline_item_nav_menu_links(),await t(),document.querySelector("#save-item-btn").addEventListener("click",itemsEditTimelineItemFormModule.update_timeline_item_record),-1!==window.location.pathname.indexOf("media")&&helperMediaModule.media_edit_init()}catch(e){document.querySelector("#message").innerHTML=`<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> ${e.message}</div>`}},e})();