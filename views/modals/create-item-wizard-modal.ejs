<style>

    #create-item-form {
        background-color: #ffffff;
        margin: 10px auto;
        padding: 40px;
        width: 100%;
    }

    .color-picker {
        background-color: none;
        outline: none;
        border: 1px solid grey;
        height: 38px;
        width: 50px;
        cursor: pointer;
    }

    input {
        padding: 10px;
        width: 80%;
        font-size: 17px;
        border: 1px solid #aaaaaa;
    }

    input.invalid {
        background-color: #ffdddd;
    }

    .input-group {
        padding: 7px;
    }

    .tab {
        display: none;
    }

    .step {
        height: 15px;
        width: 15px;
        margin: 0 2px;
        background-color: #bbbbbb;
        border: none;
        border-radius: 50%;
        display: inline-block;
        opacity: 0.5;
    }

    .step.active {
        opacity: 1;
    }

    .step.finish {
        background-color: #0394fc;
    }

    .is-error {
        color: red;
    }

</style>
<div class="modal fade show" id="create-item-modal" tabindex="-1" role="dialog"
     aria-labelledby="scrollmodalLabel" style="display: none;">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="scrollmodalLabel">Create Items</h5>
            </div>
            <div class="modal-body">
                <div class="card">
                    <div class="card-body card-block">
                        <div class="default-tab">
                            <nav>
                                <div class="nav nav-tabs" id="nav-tab" role="tablist">
                                    <a class="nav-item nav-link active" id="nav-home-tab" data-toggle="tab"
                                       href="#nav-home" role="tab" aria-controls="nav-home" aria-selected="true">Headings</a>
                                    <a class="nav-item nav-link" id="nav-profile-tab" data-toggle="tab"
                                       href="#nav-profile" role="tab" aria-controls="nav-profile" aria-selected="false">Items</a>
                                </div>
                            </nav>
                            <div class="tab-content pl-3 pt-2" id="nav-tabContent">
                                <div class="tab-pane fade show active" id="nav-home" role="tabpanel"
                                     aria-labelledby="nav-home-tab">
                                    <%- include('../modals/create-item-heading-modal.ejs'); %>
                                </div>
                                <div class="tab-pane fade" id="nav-profile" role="tabpanel"
                                     aria-labelledby="nav-profile-tab">

                                    <div id="create-item-form">
                                        <!-- Step 1 -->
                                        <div id="item-text-form" class="tab">
                                            <%- include('../partials/items/step-1-create-item-wizard-text-form.ejs'); %>
                                        </div>
                                        <!-- Step 2 -->
                                        <div id="item-upload-form" class="tab">
                                            <%- include('../partials/items/step-2-create-item-wizard-media-form.ejs'); %>
                                        </div>
                                        <!-- Step 3 -->
                                        <div id="item-template-form" class="tab">
                                            <%- include('../partials/items/step-3-create-item-wizard-template-form.ejs'); %>
                                        </div>
                                        <!-- Step 4 -->
                                        <div id="item-page-layout-form" class="tab">
                                            <%- include('../partials/items/step-4-create-item-wizard-layout-form.ejs'); %>
                                        </div>
                                        <!-- Step 5 -->
                                        <div id="item-template-styles-form" class="tab">
                                            <%- include('../partials/items/step-5-create-item-wizard-styles-form.ejs'); %>
                                        </div>
                                        <!-- Step 7 -->
                                        <div id="item-nav-styles-form" class="tab">

                                        </div>
                                        <!-- Step 8 -->
                                        <div id="confirm-item-form" class="tab">
                                            <span class="form-text text-muted" style="font-size: 17px">
                                                <div id="message"></div>
                                                <div id="display-exhibit-data"></div>
                                            </span>
                                        </div>
                                        <div style="overflow:auto;">
                                            <div style="float:right;">
                                                <button class="btn btn-default" type="button" id="prev-btn"
                                                        onclick="nextPrev(-1)">
                                                    Previous
                                                </button>
                                                <button class="btn btn-primary" type="button" id="next-btn"
                                                        onclick="nextPrev(1)">
                                                    Next
                                                </button>
                                                <span id="exhibit-form-buttons"></span>
                                            </div>
                                        </div>
                                        <!-- Circles which indicates the steps of the form: -->
                                        <div style="text-align:center;margin-top:40px;">
                                            <span class="step"></span>
                                            <span class="step"></span>
                                            <span class="step"></span>
                                            <span class="step"></span>
                                            <span class="step"></span>
                                        </div>
                                    </div><!-- end create exhibit form -->

                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                </div>
            </div>
        </div>
    </div>
</div>
<script>

    // initiate form wizard
    let current_item_wizard_tab = 0;
    show_tab(current_item_wizard_tab);

    function show_tab(n) {

        const tab = document.getElementsByClassName('tab');
        tab[n].style.display = 'block';

        console.log('tab: ', n);

        // step 0 form
        if (n === 0) {
            document.querySelector('#prev-btn').style.display = 'none';
        } else {
            document.querySelector('#prev-btn').style.display = 'inline';
        }

        if (n === 4) {

            let item_grid_template = helperModule.get_checked_radio_button(document.getElementsByName('template'));

            if (item_grid_template === 'grid') {
                document.querySelector('#item-grid-bg-color').style.display = 'block';
            }
        }

        if (n === (tab.length - 1)) {
            // final tab
            exhibitsModule.display_exhibit_data();
            document.querySelector('#next-btn').style.display = 'none';
            document.querySelector('#item-form-buttons').innerHTML = `<button class="btn btn-primary" type="button" id="save-item-btn">
                <i class="fa fa-save"></i>&nbsp;&nbsp;Save
                </button>`;

            document.querySelector('#save-item-btn').addEventListener('click', exhibitsModule.create_exhibit_record);

        } else {

            if (document.querySelector('#save-item-btn')) {
                document.querySelector('#save-item-btn').style.display = 'none';
            }

            document.querySelector('#next-btn').style.display = 'inline';
            document.querySelector('#next-btn').innerHTML = 'Next';
        }

        step_indicator(n)
    }

    function nextPrev(n) {

        const tab = document.getElementsByClassName('tab');

        if (n === 1) {
            // validating form in step 1.
            /*
            let result = validate_create_exhibit_form(current_tab);

            if (result === false) {
                return false;
            }

             */
        }

        tab[current_item_wizard_tab].style.display = 'none';
        current_item_wizard_tab = current_item_wizard_tab + n;

        if (current_item_wizard_tab >= tab.length) {
            return false;
        }

        show_tab(current_item_wizard_tab);
    }

    function step_indicator(n) {

        const step = document.getElementsByClassName('step');

        for (let i = 0; i < step.length; i++) {
            step[i].className = step[i].className.replace(' active', '');
        }

        step[n].className += ' active';
    }

    // TODO:
    function validate_create_exhibit_form(form) {

        if (form === 0) {

            /*
            let exhibit_title = EXHIBIT_TITLE.getHTMLCode();

            if (exhibit_title.length === 0 || exhibit_title.length < 4) {
                document.querySelector('#exhibit-title-error').innerHTML = '<i class="fa fa-exclamation-circle"></i>&nbsp;&nbsp;Exhibit Title is required';
                return false;
            }

             */

            document.getElementsByClassName('step')[current_item_wizard_tab].className += ' finish';
        }

        if (form === 1) {
            console.log('second tab');
            document.getElementsByClassName('step')[current_item_wizard_tab].className += ' finish';
        }

        if (form === 2) {
            console.log('third tab');
            document.getElementsByClassName('step')[current_item_wizard_tab].className += ' finish';
        }
    }

</script>