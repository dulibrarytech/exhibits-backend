let itemsCommonVerticalTimelineItemFormModule=(()=>{let a=endpointsModule.get_exhibits_endpoints();var e={get_common_timeline_item_form_fields:function(e){try{var t=[],a={styles:{}};if(a.title=document.querySelector("#item-title-input").value,a.description=document.querySelector("#item-description-input").value,a.text=document.querySelector("#item-text-input").value,a.caption=document.querySelector("#item-caption-input").value,a.is_alt_text_decorative=document.querySelector("#is-alt-text-decorative").checked,a.date=document.querySelector('input[type="date"]').value,a.is_embedded=document.querySelector("#embed-item").checked,!0===a.is_embedded?a.is_embedded=1:!1===a.is_embedded&&(a.is_embedded=0),0===a.date.length)return!(document.querySelector("#message").innerHTML='<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> Please enter a timeline date</div>');if(a.thumbnail=document.querySelector("#item-thumbnail").value,a.thumbnail_prev=document.querySelector("#item-thumbnail-image-prev").value,a.item_type=document.querySelector("#item-type").value,a.mime_type=document.querySelector("#item-mime-type").value,a.media=document.querySelector("#item-media").value,a.media_prev=document.querySelector("#item-media-prev").value,a.kaltura=document.querySelector("#audio-video").value,a.repo_uuid=document.querySelector("#repo-uuid").value,a.pdf_open_to_page=document.querySelector("#pdf-open-to-page").value,-1!==a.mime_type.indexOf("image"))if(!0===a.is_alt_text_decorative)a.is_alt_text_decorative=1,a.alt_text="";else if(!1===a.is_alt_text_decorative&&(a.is_alt_text_decorative=0,a.alt_text=document.querySelector("#item-alt-text-input").value,0===a.alt_text.length)&&0===a.alt_text.length&&0===a.alt_text.length)return!(document.querySelector("#message").innerHTML='<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> Please enter "alt text" for this item</div>');if(0===a.media.length&&0===a.kaltura.length&&0===a.repo_uuid.length&&0===a.text.length)return document.querySelector("#message").innerHTML=`<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> Please add item content to the 'Text' field OR upload or import a media item</div>`,!1;if(0<a.media.length&&0<a.repo_uuid.length&&a.media===a.repo_uuid&&(a.repo_uuid=""),0<a.media.length&&0<a.kaltura.length&&a.media===a.kaltura&&(a.kaltura=""),0<a.media.length&&t.push(a.media),0<a.kaltura.length&&(t.push(a.kaltura),a.item_type="kaltura"),0<a.repo_uuid.length&&t.push(a.repo_uuid),1<t.length)return!(document.querySelector("#message").innerHTML='<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> Please upload or import only one media item</div>');"kaltura"===a.item_type&&(a.item_type=document.querySelector('input[name="item_type"]:checked').value),0===t.length&&0!==a.text.length&&(a.item_type="text");var l=document.querySelector("#item-background-color").value,i=document.querySelector("#item-font-color").value,r=document.querySelector("#item-font").value,o=document.querySelector("#item-font-size").value;return 0<l.length&&(a.styles.backgroundColor=l),0<i.length&&(a.styles.color=document.querySelector("#item-font-color").value),0<r.length&&(a.styles.fontFamily=r),0<o.length&&(a.styles.fontSize=o+"px"),a}catch(e){document.querySelector("#message").innerHTML=`<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> ${e.message}</div>`}}};return e.delete_media=function(){try{(async()=>{var e=document.querySelector("#item-media").value,t=authModule.get_user_token();void 0!==(e=await httpModule.req({method:"DELETE",url:a.exhibits.media.delete.endpoint+"?media="+e,headers:{"Content-Type":"application/json","x-access-token":t}}))&&204===e.status&&(document.querySelector("#item-media").value="",document.querySelector("#item-media-thumbnail-image-display").innerHTML="",document.querySelector("#item-media-filename-display").innerHTML="",document.querySelector("#item-media-trash").style.display="none",document.querySelector("#message").innerHTML='<div class="alert alert-success" role="alert"><i class="fa fa-info"></i> Media deleted</div>',document.querySelector("#toggle-open-to-page").style.visibility="hidden",setTimeout(()=>{document.querySelector("#message").innerHTML=""},3e3))})()}catch(e){document.querySelector("#message").innerHTML=`<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> ${e.message}</div>`}return!1},e.delete_thumbnail_image=function(){try{(async()=>{var e=document.querySelector("#item-thumbnail").value,t=authModule.get_user_token();void 0!==(e=await httpModule.req({method:"DELETE",url:a.exhibits.media.delete.endpoint+"?media="+e,headers:{"Content-Type":"application/json","x-access-token":t}}))&&204===e.status&&(document.querySelector("#item-thumbnail").value="",document.querySelector("#item-thumbnail-image-display").innerHTML="",document.querySelector("#item-thumbnail-filename-display").innerHTML="",document.querySelector("#item-thumbnail-trash").style.display="none",document.querySelector("#item-media-thumbnail-image-display").innerHTML="",document.querySelector("#message").innerHTML='<div class="alert alert-success" role="alert"><i class="fa fa-info"></i> Thumbnail image deleted</div>',setTimeout(()=>{document.querySelector("#message").innerHTML=""},3e3))})()}catch(e){document.querySelector("#message").innerHTML=`<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> ${e.message}</div>`}return!1},e.init=async function(){try{uploadsModule.upload_item_media(),uploadsModule.upload_item_thumbnail();var e=authModule.get_user_token();await authModule.check_auth(e),navModule.init(),navModule.back_to_timeline_items(),navModule.set_preview_link(),document.querySelector("#item-media-trash").style.display="none",document.querySelector("#item-thumbnail-trash").style.display="none",document.querySelector("#item-background-color-picker").addEventListener("input",()=>{document.querySelector("#item-background-color")&&(document.querySelector("#item-background-color").value=document.querySelector("#item-background-color-picker").value)}),document.querySelector("#item-font-color-picker").addEventListener("input",()=>{document.querySelector("#item-font-color")&&(document.querySelector("#item-font-color").value=document.querySelector("#item-font-color-picker").value)}),setTimeout(()=>{document.querySelector("#item-media-trash").addEventListener("click",itemsCommonVerticalTimelineItemFormModule.delete_media),document.querySelector("#item-thumbnail-trash").addEventListener("click",itemsCommonVerticalTimelineItemFormModule.delete_thumbnail_image)},1e3),document.querySelector("#repo-uuid-btn").addEventListener("click",async()=>{await helperModule.get_repo_item_data(null)}),helperModule.show_form()}catch(e){document.querySelector("#message").innerHTML=`<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> ${e.message}</div>`}},e})();