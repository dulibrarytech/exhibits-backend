let exhibitsModule=(()=>{let m=window.localStorage.getItem("exhibits_app_path");var e={};let i;async function b(){try{var t=endpointsModule.get_exhibits_endpoints();if(!t?.exhibits?.exhibit_records?.endpoint)throw new Error("Exhibits endpoint configuration not available");var i=authModule.get_user_token();if(!i||"string"!=typeof i)throw new Error("Authentication token not available");var a=await httpModule.req({method:"GET",url:t.exhibits.exhibit_records.endpoint,headers:{"Content-Type":"application/json","x-access-token":i},timeout:3e4});if(a&&200===a.status)return a.data&&Array.isArray(a.data.data)?a.data.data:(console.warn("Unexpected response data structure:",a.data),[]);if(a)throw new Error("Request failed with status "+a.status)}catch(e){console.error("Error fetching exhibits:",e),t=e.message,(i=document.querySelector("#message"))?(i.textContent="",(a=document.createElement("div")).className="alert alert-danger",a.setAttribute("role","alert"),a.setAttribute("aria-live","polite"),a.setAttribute("aria-atomic","true"),(r=document.createElement("i")).className="fa fa-exclamation",r.setAttribute("aria-hidden","true"),a.appendChild(r),a.appendChild(document.createTextNode(" ")),r=document.createTextNode(t),a.appendChild(r),i.appendChild(a)):console.error("Message element #message not found in DOM")}var r}function f(e,t){var i=document.createElement("td"),t=(i.style.width="4%",i.className="item-order",i.setAttribute("aria-label",t),document.createElement("span")),e=(t.style.paddingLeft="4px",new Date(e)),e=helperModule.format_date(e);return t.textContent=e,i.appendChild(t),i}function x(e,t,i,a){var r=document.createElement("i");return r.className=e,t&&r.setAttribute("title",t),i?r.setAttribute("aria-label",i):r.setAttribute("aria-hidden","true"),a&&(r.style.color=a),r}function C(e,t,i,a){var r=document.createElement("a");return r.href=e,t&&r.setAttribute("title",t),i&&r.setAttribute("aria-label",i),a&&(e=x(a,"","",""),r.appendChild(e),r.appendChild(document.createTextNode(" "))),r}e.display_exhibits=async function(){try{var t=await b();if(!1===t)return(d=document.querySelector("#exhibit-card"))&&(d.textContent=""),!1;if(void 0===t)return authModule.redirect_to_auth(),!1;if(!t||0===t.length)return(p=document.querySelector(".card"))&&(p.textContent=""),(e=document.querySelector("#message"))?(e.textContent="",(u=document.createElement("div")).className="alert alert-info",u.setAttribute("role","status"),u.setAttribute("aria-live","polite"),u.setAttribute("aria-atomic","true"),h=document.createTextNode("No Exhibits found."),u.appendChild(h),e.appendChild(u)):console.warn("Message element not found"),!1;var i=document.querySelector("#exhibits-data");if(!i)throw new Error("Table body element #exhibits-data not found");i.textContent="";var a=document.createDocumentFragment();for(let e=0;e<t.length;e++){s=t[e],c=void 0,(c=document.createElement("tr")).id=s.uuid,c.appendChild((e=>{var t=document.createElement("td"),i=(t.style.width="35%",(e=>{var t=document.createElement("p"),i=document.createElement("strong"),a=helperModule.strip_html(helperModule.unescape(e.title));return i.textContent=a,t.appendChild(i),1===e.is_featured&&(t.appendChild(document.createTextNode("  ")),a=x("fa fa-star","Featured","featured exhibit","#BA8E23"),t.appendChild(a)),1===e.is_locked&&(t.appendChild(document.createTextNode("  ")),i=x("fa fa-lock","Record is currently locked","exhibit-is-locked","#BA8E23"),t.appendChild(i)),t})(e)),i=(t.appendChild(i),(e=>{let t=document.createElement("p"),i=document.createElement("img"),a=m+"/static/images/image-tn.png",r;return r=e.thumbnail&&0<e.thumbnail.length?`${m}/api/v1/exhibits/${encodeURIComponent(e.uuid)}/media/`+encodeURIComponent(e.thumbnail):a,i.src=r,i.alt=e.uuid+" thumbnail",i.height=100,i.width=100,i.addEventListener("error",function(){this.src!==a&&(console.warn(`Thumbnail failed to load for exhibit ${e.uuid}, using default image`),this.src=a)}),t.appendChild(i),t})(e)),i=(t.appendChild(i),(e=>{let t=document.createElement("div"),i=(t.className="d-flex justify-content-between align-items-center",document.createElement("div")),a=(i.className="btn-group",document.createElement("span")),r=(a.id="preview-link",document.createElement("button")),n=(r.type="button",r.className="btn btn-sm btn-outline-secondary",r.setAttribute("aria-label","Preview exhibit"),document.createElement("i")),o=(n.className="menu-icon fa fa-eye",n.setAttribute("aria-hidden","true"),r.appendChild(n),r.appendChild(document.createTextNode(" ")),document.createElement("small")),d=(o.textContent="Preview",r.appendChild(o),m+"/preview?uuid="+encodeURIComponent(e.uuid)),l=(r.addEventListener("click",()=>{exhibitsModule.open_preview(d)}),a.appendChild(r),i.appendChild(a),i.appendChild(document.createTextNode("  ")),document.createElement("span")),s=(l.id="share-link",document.createElement("button")),c=(s.type="button",s.className="btn btn-sm btn-outline-secondary",s.setAttribute("aria-label","Share exhibit"),s.setAttribute("data-toggle","modal"),s.setAttribute("data-target",".shared-url-modal"),document.createElement("i")),u=(c.className="fa fa-share-alt",c.setAttribute("aria-hidden","true"),s.appendChild(c),s.appendChild(document.createTextNode(" ")),document.createElement("small"));return u.textContent="Share",s.appendChild(u),s.addEventListener("click",()=>{exhibitsModule.create_shared_preview_url(e.uuid)}),l.appendChild(s),i.appendChild(l),t.appendChild(i),t})(e)),i=(t.appendChild(i),(e=>{var t=document.createElement("p"),i=document.createElement("span"),a=(i.style.fontSize="x-small",document.createElement("em"));return a.textContent="Exhibit created by "+e,i.appendChild(a),t.appendChild(i),t})(e.created_by));return t.appendChild(i),t})(s)),c.appendChild((e=>{var t=document.createElement("td"),i=(t.style.width="5%",t.style.textAlign="center",document.createElement("small")),e=((e,t)=>{var i=document.createElement("a"),e=(i.href="#",i.id=e+"-status",i.setAttribute("aria-label","Toggle publication status"),document.createElement("span"));return 1===t?(i.className="suppress-exhibit",e.id="suppress",e.setAttribute("title","published"),(t=document.createElement("i")).className="fa fa-cloud",t.style.color="green",t.setAttribute("aria-hidden","true"),e.appendChild(t),e.appendChild(document.createElement("br")),e.appendChild(document.createTextNode("Published"))):(i.className="publish-exhibit",e.id="publish",e.setAttribute("title","suppressed"),(t=document.createElement("i")).className="fa fa-cloud-upload",t.style.color="darkred",t.setAttribute("aria-hidden","true"),e.appendChild(t),e.appendChild(document.createElement("br")),e.appendChild(document.createTextNode("Unpublished"))),i.appendChild(e),i})(e.uuid,e.is_published);return i.appendChild(e),t.appendChild(i),t})(s)),c.appendChild((e=>{var t=document.createElement("td"),i=(t.style.width="10%",document.createElement("div")),a=(i.className="card-text text-sm-center",i.id=e.uuid+"-actions",C(m+"/items?exhibit_id="+encodeURIComponent(e.uuid),"View Exhibit Items","view-exhibit-items","fa fa-list"));return a.classList.add("pr-1"),i.appendChild(a),i.appendChild(document.createTextNode(" ")),1===e.is_published?((a=C(m+"/exhibits/exhibit/details?exhibit_id="+encodeURIComponent(e.uuid),"View details","exhibit-details","fa fa-folder-open")).classList.add("pr-1"),i.appendChild(a),i.appendChild(document.createTextNode(" ")),(a=document.createElement("i")).className="fa fa-trash pr-1",a.setAttribute("title","Can only delete if unpublished"),a.setAttribute("aria-label","delete-exhibit"),a.style.color="#d3d3d3",i.appendChild(a)):((a=C(m+"/exhibits/exhibit/edit?exhibit_id="+encodeURIComponent(e.uuid),"Edit","edit-exhibit","fa fa-edit")).classList.add("pr-1"),i.appendChild(a),i.appendChild(document.createTextNode(" ")),(a=C(m+"/exhibits/exhibit/delete?exhibit_id="+encodeURIComponent(e.uuid),"Delete exhibit","delete-exhibit","fa fa-trash")).classList.add("pr-1"),i.appendChild(a)),t.appendChild(i),t})(s)),c.appendChild(f(s.created,"exhibit-created")),c.appendChild(f(s.updated,"exhibit-updated"));var r=c;a.appendChild(r)}i.appendChild(a);var n=(()=>{try{if(document.querySelector("#exhibits"))return new DataTable("#exhibits",{paging:!0,order:[[4,"desc"]],rowReorder:!1,language:{bottomEnd:{paging:{firstLast:!1}}}});throw new Error("Table element #exhibits not found")}catch(e){throw console.error("Error initializing DataTable:",e),e}})();if(n)try{n.on("click","tbody tr .publish-exhibit",async e=>{e.preventDefault();e=e.currentTarget.getAttribute("id");e?await g(e):console.error("No UUID found on publish button")}),n.on("click","tbody tr .suppress-exhibit",async e=>{e.preventDefault();e=e.currentTarget.getAttribute("id");e?await v(e):console.error("No UUID found on suppress button")})}catch(e){console.error("Error binding DataTable events:",e)}else console.error("DataTable instance not provided");try{var o=helperModule.get_parameter_by_name("exhibit_id");if(null!==o&&""!==o){history.replaceState({},"",m+"/exhibits"),history.pushState({},"",m+"/exhibits");let e=document.getElementById(o);e?(e.scrollIntoView({behavior:"smooth",block:"center"}),e.style.backgroundColor="#fffacd",setTimeout(()=>{e.style.backgroundColor=""},2e3)):console.warn(`Exhibit with ID ${o} not found in DOM`)}}catch(e){console.error("Error handling exhibit_id parameter:",e)}return!0}catch(e){console.error("Error displaying exhibits:",e);var d=document.querySelector("#message");return d&&(i=d,n="danger",d="Error displaying exhibits: "+e.message,i?(i.textContent="",(l=document.createElement("div")).className="alert alert-"+n,l.setAttribute("role","alert"),l.setAttribute("aria-live","polite"),l.setAttribute("aria-atomic","true"),n=x({info:"fa fa-info",success:"fa fa-check",danger:"fa fa-exclamation",warning:"fa fa-exclamation-triangle"}[n]||"fa fa-info","","",""),l.appendChild(n),l.appendChild(document.createTextNode(" ")),n=document.createTextNode(d),l.appendChild(n),i.appendChild(l)):console.error("Display message: element not found")),!1}var l,s,c,e,u,h,p},e.get_exhibit_title=async function(e){try{var t=endpointsModule.get_exhibits_endpoints(),i=authModule.get_user_token(),a=await httpModule.req({method:"GET",url:t.exhibits.exhibit_records.endpoints.get.endpoint.replace(":exhibit_id",e),headers:{"Content-Type":"application/json","x-access-token":i}});if(void 0!==a&&200===a.status)return helperModule.strip_html(helperModule.unescape(a.data.data.title))}catch(e){document.querySelector("#message").innerHTML=`<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> ${e.message}</div>`}},e.set_exhibit_title=async function(e){e=await exhibitsModule.get_exhibit_title(e);return document.querySelector("#exhibit-title").innerHTML=""+e,!1},e.open_preview=function(e){scrollTo(0,0);let t=authModule.get_user_token();void 0!==i&&exhibitsModule.close_preview(),document.querySelector("#message").innerHTML='<div class="alert alert-info" role="alert"><i class="fa fa-info-circle"></i> Building Exhibit Preview...</div>',setTimeout(()=>{i=window.open(e+"&t="+t,"_blank","location=yes,scrollbars=yes,status=yes"),document.querySelector("#message").innerHTML=""},900)},e.close_preview=function(){i.close()},e.delete_exhibit=function(){try{(async()=>{document.querySelector("#delete-message").innerHTML="Deleting exhibit...";var e=endpointsModule.get_exhibits_endpoints(),t=helperModule.get_parameter_by_name("exhibit_id"),i=authModule.get_user_token();void 0!==(e=await httpModule.req({method:"DELETE",url:e.exhibits.exhibit_records.endpoints.delete.endpoint.replace(":exhibit_id",t),headers:{"Content-Type":"application/json","x-access-token":i}}))&&204===e.status?setTimeout(()=>{window.location.replace(m+"/exhibits")},900):void 0!==e&&200===e.status?(scrollTo(0,0),document.querySelector("#delete-card").innerHTML="",document.querySelector("#message").innerHTML='<div class="alert alert-warning" role="alert"><i class="fa fa-warning"></i> Cannot delete an exhibit that contains items.</div>'):void 0===e&&(scrollTo(0,0),document.querySelector("#delete-card").innerHTML="",document.querySelector("#message").innerHTML='<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> You do not have permission to delete this record.</div>')})()}catch(e){document.querySelector("#message").innerHTML=`<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> ${e.message}</div>`}return!1};let o={STATUS_SUFFIX:"-status",ACTIONS_SUFFIX:"-actions",MESSAGE_DURATION:5e3,HTTP_OK:200,HTTP_NO_CONTENT:204,UUID_PATTERN:/^[a-f0-9-]+$/i},n={PUBLISHED:{span_id:"suppress",title:"published",icon_class:"fa fa-cloud",icon_color:"green",text:"Published",css_class_to_add:"suppress-exhibit",css_class_to_remove:"publish-exhibit",click_handler:v,actions:(e,t)=>[{href:e+"/items?exhibit_id="+t,title:"View Exhibit Items",icon:"fa fa-list pr-1",label:"view-items"},{href:e+"/exhibits/exhibit/details?exhibit_id="+t,title:"View details",icon:"fa fa-folder-open pr-1",label:"exhibit-details"},{type:"disabled-trash"}]},SUPPRESSED:{span_id:"publish",title:"suppressed",icon_class:"fa fa-cloud-upload",icon_color:"darkred",text:"Unpublished",css_class_to_add:"publish-exhibit",css_class_to_remove:"suppress-exhibit",click_handler:g,actions:(e,t)=>[{href:e+"/items?exhibit_id="+t,title:"View Exhibit Items",icon:"fa fa-list pr-1",label:"view-items"},{href:e+"/exhibits/exhibit/edit?exhibit_id="+t,title:"Edit",icon:"fa fa-edit pr-1",label:"edit-exhibit"},{href:e+"/exhibits/exhibit/delete?exhibit_id="+t,title:"Delete exhibit",icon:"fa fa-trash pr-1",label:"delete-exhibit"}]}};function d(e){if(!e||"string"!=typeof e)throw new Error("Invalid exhibit UUID provided");e=e.replace(o.STATUS_SUFFIX,"");if(o.UUID_PATTERN.test(e))return e;throw new Error("Invalid UUID format")}function l(e){if(!e)throw new Error("Authentication token not available")}async function s(e,t,i){return httpModule.req({method:"POST",url:e.replace(":exhibit_id",t),headers:{"Content-Type":"application/json","x-access-token":i},validateStatus:e=>200<=e&&e<600})}function c(e,t){var i=document.getElementById(e);if(i){for(i.classList.remove(t.css_class_to_remove),i.classList.add(t.css_class_to_add);i.firstChild;)i.removeChild(i.firstChild);var a=document.createElement("span"),r=(a.id=t.span_id,a.title=t.title,document.createElement("i")),n=(r.className=t.icon_class,r.style.color=t.icon_color,r.setAttribute("aria-hidden","true"),document.createElement("br")),t=document.createTextNode(t.text);a.appendChild(r),a.appendChild(n),a.appendChild(t),i.appendChild(a)}else console.warn("Status element not found: "+e)}function u(e,t){var i=""+e+o.ACTIONS_SUFFIX;let a=document.getElementById(i);if(a){for(;a.firstChild;)a.removeChild(a.firstChild);var e=encodeURIComponent(e),r=void 0!==m?m:"";let o=t.actions(r,e),d=[];o.forEach((e,t)=>{var i,a,r,n;"disabled-trash"===e.type?d.push(((n=document.createElement("i")).className="fa fa-trash pr-1",n.title="Can only delete if unpublished",n.style.color="#d3d3d3",n.setAttribute("aria-label","delete-exhibit"),n.setAttribute("aria-disabled","true"),n.setAttribute("aria-hidden","true"),n)):d.push((n=e.href,i=e.title,a=e.icon,e=e.label,(r=document.createElement("a")).href=n,r.title=i,r.setAttribute("aria-label",e),(n=document.createElement("i")).className=a,n.setAttribute("aria-hidden","true"),r.appendChild(n),r)),t<o.length-1&&d.push(document.createTextNode(" "))}),d.forEach(e=>a.appendChild(e))}else console.warn("Actions element not found: "+i)}async function g(e){try{var t=d(e),i=endpointsModule.get_exhibits_endpoints(),a=authModule.get_user_token(),r=(l(a),await s(i.exhibits.exhibit_publish.post.endpoint,t,a));return r?.status===o.HTTP_OK?(c(e,n.PUBLISHED),u(t,n.PUBLISHED)):r?.status===o.HTTP_NO_CONTENT?h("warning","Exhibit must contain at least one item to publish"):r||h("danger","You do not have permission to publish this record"),!1}catch(e){return console.error("Error publishing exhibit:",e),h("danger",e.message||"An unexpected error occurred while publishing the exhibit"),!1}}async function v(e){try{var t=d(e),i=endpointsModule.get_exhibits_endpoints(),a=authModule.get_user_token(),r=(l(a),await s(i.exhibits.exhibit_suppress.post.endpoint,t,a));return r?.status===o.HTTP_OK?(c(e,n.SUPPRESSED),u(t,n.SUPPRESSED)):r||h("danger","You do not have permission to unpublish this record"),!1}catch(e){return console.error("Error suppressing exhibit:",e),h("danger",e.message||"An error occurred while suppressing exhibit"),!1}}function h(t,i,a=o.MESSAGE_DURATION){let r=document.querySelector("#message");if(r){for(window.scrollTo({top:0,behavior:"smooth"});r.firstChild;)r.removeChild(r.firstChild);let e=document.createElement("div");e.className="alert alert-"+t,e.setAttribute("role","alert");var n=document.createElement("i"),t=(n.className="warning"===t?"fa fa-warning":"fa fa-exclamation-circle",n.setAttribute("aria-hidden","true"),document.createTextNode(" "+i));e.appendChild(n),e.appendChild(t),r.appendChild(e),setTimeout(()=>{r.firstChild===e&&r.removeChild(e)},a)}else console.error("Message container not found")}function p(e){try{var t=new URL(e);return"http:"===t.protocol||"https:"===t.protocol}catch(e){}}function y(e,t){_(e,"info",t,"fa-info-circle")}function _(e,t,i,a){var r=document.querySelector(e);if(r){for(;r.firstChild;)r.removeChild(r.firstChild);var n=document.createElement("div"),t=(n.className="alert alert-"+t,n.setAttribute("role","alert"),document.createElement("i")),a=(t.className="fa "+a,t.setAttribute("aria-hidden","true"),document.createTextNode(" "+i));n.appendChild(t),n.appendChild(a),r.appendChild(n)}else console.error("Container not found: "+e)}function p(e){try{var t=new URL(e);return"http:"===t.protocol||"https:"===t.protocol}catch(e){}}return e.create_shared_preview_url=async function(t){try{if(t&&"string"==typeof t)if(/^[a-f0-9-]+$/i.test(t)){y("#shared-url","Generating Shared URL...");var i=endpointsModule.get_exhibits_endpoints(),e=authModule.get_user_token();if(e&&!1!==e){var a=encodeURIComponent(t),r=await httpModule.req({method:"POST",url:i.exhibits.exhibit_shared.get.endpoint+"?uuid="+a,headers:{"Content-Type":"application/json","x-access-token":e},validateStatus:e=>200<=e&&e<600});if(201===r?.status&&r.data?.shared_url){if(!p(r.data.shared_url))throw new Error("Invalid shared URL received from server");var n=document.querySelector("#shared-url-copy");n&&(n.textContent=r.data.shared_url),setTimeout(()=>{var e=7,t=document.querySelector("#shared-url");if(t){for(;t.firstChild;)t.removeChild(t.firstChild);var i=document.createElement("div"),a=(i.className="d-flex align-items-center",document.createElement("p")),r=document.createTextNode("- Shared URL created.  "),r=(a.appendChild(r),document.createElement("button")),n=(r.type="button",r.className="btn btn-sm btn-primary",r.setAttribute("aria-label","Copy shared URL"),r.addEventListener("click",e=>{e.preventDefault(),void 0!==exhibitsModule&&"function"==typeof exhibitsModule.copy?exhibitsModule.copy():console.error("exhibitsModule.copy is not available")}),document.createElement("i")),o=(n.className="fa fa-copy",n.setAttribute("aria-hidden","true"),document.createTextNode(" Copy")),n=(r.appendChild(n),r.appendChild(o),a.appendChild(r),document.createElement("br")),o=(a.appendChild(n),document.createTextNode(`- Shared URL expires in ${e} days.`));a.appendChild(o),i.appendChild(a),t.appendChild(i)}else console.error("Shared URL container not found")},900)}else y("#shared-url",r?.data?.message||"Failed to create shared URL")}else setTimeout(()=>{y("#message","Unable to get session token"),authModule.logout()},1e3)}else y("#shared-url","Invalid UUID format");else y("#shared-url","Invalid exhibit UUID provided");return!1}catch(e){return console.error("Error creating shared preview URL:",e),t="#shared-url",i=e.message||"An error occurred while creating the shared URL",_(t,"danger",i,"fa-exclamation-circle"),!1}},e.copy=async function(){var i="#copy-message";try{var t=document.querySelector("#shared-url-copy");if(!t)throw new Error("Shared URL element not found");var a=t.textContent.trim();if(!a)throw new Error("No URL available to copy");if(!p(a))throw new Error("Invalid URL format");await(async e=>{if(navigator.clipboard&&navigator.clipboard.writeText)try{return void await navigator.clipboard.writeText(e)}catch(e){console.warn("Clipboard API failed, trying fallback:",e)}var t=document.createElement("textarea");t.value=e,t.style.position="fixed",t.style.top="-9999px",t.style.left="-9999px",t.style.opacity="0",t.setAttribute("readonly",""),t.setAttribute("aria-hidden","true"),document.body.appendChild(t);try{if(t.select(),t.setSelectionRange(0,e.length),!document.execCommand("copy"))throw new Error("Copy command was unsuccessful")}finally{document.body.removeChild(t)}})(a);{var r=i;var n=5e3;let t=document.querySelector(r);if(t){for(;t.firstChild;)t.removeChild(t.firstChild);let e=document.createElement("div");e.className="alert alert-info",e.setAttribute("role","alert");var o=document.createElement("i"),d=(o.className="fa fa-info-circle",o.setAttribute("aria-hidden","true"),document.createTextNode(" URL copied to clipboard!"));e.appendChild(o),e.appendChild(d),t.appendChild(e),setTimeout(()=>{t.firstChild===e&&t.removeChild(e)},n)}else console.warn("Copy message container not found: "+r);return}}catch(e){console.error("Error copying to clipboard:",e);var t=i,a=e.message,l=document.querySelector(t);if(l){for(;l.firstChild;)l.removeChild(l.firstChild);n=document.createElement("div"),r=(n.className="alert alert-danger",n.setAttribute("role","alert"),document.createElement("i")),a=(r.className="fa fa-exclamation-circle",r.setAttribute("aria-hidden","true"),a||"Failed to copy URL to clipboard"),a=document.createTextNode(" "+a);n.appendChild(r),n.appendChild(a),l.appendChild(n)}else console.error("Copy message container not found: "+t)}},e.init=async function(){try{var t=authModule.get_user_token();t&&!1!==t?await authModule.check_auth(t)?await Promise.all([(async()=>{try{await exhibitsModule.display_exhibits()}catch(e){throw console.error("Error displaying exhibits:",e),new Error("Failed to load exhibits. Please refresh the page.")}})(),(async()=>{try{"undefined"!=typeof helperModule&&"function"==typeof helperModule.show_form?helperModule.show_form():console.warn("helperModule.show_form is not available"),"undefined"!=typeof navModule&&"function"==typeof navModule.set_logout_link?navModule.set_logout_link():console.warn("navModule.set_logout_link is not available")}catch(e){console.error("Error initializing UI components:",e)}})()]):(console.warn("Authentication check failed"),authModule.logout()):(console.warn("No authentication token available"),authModule.logout())}catch(e){console.error("Error initializing exhibits module:",e);var t=e,i=document.querySelector("#message");if(i){for(;i.firstChild;)i.removeChild(i.firstChild);var a=document.createElement("div"),r=(a.className="alert alert-danger",a.setAttribute("role","alert"),document.createElement("i")),t=(r.className="fa fa-exclamation-circle",r.setAttribute("aria-hidden","true"),(e=>{if(!e||!e.message)return"An unexpected error occurred. Please try again.";var t,i,a=e.message.toLowerCase();for([t,i]of Object.entries({network:"Network error. Please check your connection and try again.",timeout:"Request timed out. Please try again.",token:"Session expired. Please log in again.",auth:"Authentication failed. Please log in again.",permission:"You do not have permission to access this resource.","not found":"The requested resource was not found."}))if(a.includes(t))return i;return"An error occurred while initializing the page. Please refresh and try again."})(t)),t=document.createTextNode(" "+t);a.appendChild(r),a.appendChild(t),i.appendChild(a)}else console.error("Message container not found, cannot display error to user")}},e})();