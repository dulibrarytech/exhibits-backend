let helperModule=(()=>{var e={get_parameter_by_name:function(e,t){try{t=t||window.location.href,e=e.replace(/[\[\]]/g,"\\$&");var r=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return r?r[2]?decodeURIComponent(DOMPurify.sanitize(r[2].replace(/\+/g," "))):"":null}catch(e){document.querySelector("#message").innerHTML=`<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> ${e.message}</div>`}},unescape:function(e){try{var t=document.createElement("textarea");return t.innerHTML=e,t.value}catch(e){document.querySelector("#message").innerHTML=`<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> ${e.message}</div>`}},strip_html:function(e){try{return e.replace(/(<([^>]+)>)/gi,"")}catch(e){document.querySelector("#message").innerHTML=`<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> ${e.message}</div>`}},clean_html:function(e){try{var t=document.createElement("div"),r=(t.innerHTML=e,["script","iframe","html","head","body","head","title","img","embed","applet","object","style","link","form","input","video","source","math","maction","picture","map","svg","details","frameset","comment","base"]);for(let e=0;e<r.length;e++)for(var a=t.getElementsByTagName(r[e]);a[0];)a[0].parentNode.removeChild(a[0]);return t.innerHTML.replace(/&amp;/g,"&")}catch(e){document.querySelector("#message").innerHTML=`<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> ${e.message}</div>`}},preview_html:function(e){try{var t=helperModule.clean_html(document.querySelector("#"+e).value);return document.querySelector("#preview-html").innerHTML=t,document.querySelector("#"+e).value=t,!1}catch(e){document.querySelector("#message").innerHTML=`<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> ${e.message}</div>`}},get_checked_radio_button:function(t){try{for(let e=0;e<t.length;e++)if(t[e].checked)return t[e].value}catch(e){document.querySelector("#message").innerHTML=`<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> ${e.message}</div>`}},get_current_year:function(){try{var e=(new Date).getFullYear();domModule.html("#cdate",DOMPurify.sanitize(e))}catch(e){document.querySelector("#message").innerHTML=`<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> ${e.message}</div>`}},format_date:function(e){return(1+e.getMonth()).toString().padStart(2,"0")+`/${e.getDate().toString().padStart(2,"0")}/${e.getFullYear()} @ ${e.getHours().toString().padStart(2,"0")}:${e.getMinutes().toString().padStart(2,"0")}:`+e.getSeconds().toString().padStart(2,"0")},show_form:function(){try{let e=Array.from(document.getElementsByClassName("card"));setTimeout(()=>{e.forEach(e=>{e.style.visibility="visible"})},250)}catch(e){document.querySelector("#message").innerHTML=`<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> ${e.message}</div>`}},reorder_exhibits:async function(e,a){try{var t=endpointsModule.get_exhibits_endpoints(),i=helperModule.get_parameter_by_name("exhibit_id");let r={};var n=[];for(let e=0,t=a.length;e<t;e++){var o=a[e].node.getAttribute("id").split("_");r.type=o.pop(),r.uuid=o.pop(),r.order=a[e].node.childNodes[0].childNodes[1].innerText,n.push(r),r={}}var l=authModule.get_user_token(),s=await httpModule.req({method:"POST",url:t.exhibits.reorder_exhibits_records.post.endpoint.replace(":exhibit_id",i),data:n,headers:{"Content-Type":"application/json","x-access-token":l}});void 0!==s&&201===s.status?console.log(s):document.querySelector("#message").innerHTML='<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> An HTTP request error occurred while reordering items.</div>'}catch(e){document.querySelector("#message").innerHTML=`<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> ${e.message}</div>`}},reorder_items:async function(e,a){try{if(0===a.length)return!1;var t=endpointsModule.get_exhibits_endpoints(),i=helperModule.get_parameter_by_name("exhibit_id"),n=helperModule.get_parameter_by_name("grid_id");let r={};var o=[];for(let e=0,t=a.length;e<t;e++){var l=a[e].node.getAttribute("id").split("_");r.type=l.pop(),r.uuid=l.pop(),r.order=a[e].node.childNodes[0].childNodes[1].innerText,null!==n&&(r.grid_id=n),o.push(r),r={}}var s=authModule.get_user_token(),d=await httpModule.req({method:"POST",url:t.exhibits.reorder_records.post.endpoint.replace(":exhibit_id",i),data:o,headers:{"Content-Type":"application/json","x-access-token":s}});void 0!==d&&201===d.status?console.log("items reordered"):document.querySelector("#message").innerHTML='<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> An HTTP request error occurred while reordering items.</div>'}catch(e){document.querySelector("#message").innerHTML=`<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> ${e.message}</div>`}},reorder_grid_items:async function(e,a){try{if(0===a.length)return!1;var t=endpointsModule.get_exhibits_endpoints(),i=helperModule.get_parameter_by_name("exhibit_id"),n=helperModule.get_parameter_by_name("grid_id");let r={};var o=[];for(let e=0,t=a.length;e<t;e++){var l=a[e].node.getAttribute("id").split("_");r.grid_id=n,r.uuid=l[0],r.type="griditem",r.order=a[e].node.childNodes[0].childNodes[1].innerText,o.push(r),r={}}var s=authModule.get_user_token(),d=await httpModule.req({method:"POST",url:t.exhibits.reorder_records.post.endpoint.replace(":exhibit_id",i),data:o,headers:{"Content-Type":"application/json","x-access-token":s}});void 0!==d&&201===d.status?console.log("items reordered"):document.querySelector("#message").innerHTML='<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> An HTTP request error occurred while reordering items.</div>'}catch(e){document.querySelector("#message").innerHTML=`<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> ${e.message}</div>`}},check_if_locked:function(e,t){var r=authModule.get_user_profile_data();1===e.is_locked&&e.locked_by_user!==parseInt(r.uid)&&(document.querySelector(t).style.display="none",null!==document.querySelector("#message")&&(document.querySelector("#message").innerHTML=`<div class="alert alert-warning" role="alert"><i class="fa fa-lock"></i> This record is currently being worked on by another user.  <br><span><div class="btn-group float-right">
                    <button class="btn btn-xs btn-secondary"><i class="fa fa-unlock-alt"></i> Unlock</button>
                </div></span></div>`),document.addEventListener("click",helperModule.unlock_record))},unlock_record:async function(){var e,t,r=endpointsModule.get_exhibits_endpoints(),a=helperModule.get_parameter_by_name("exhibit_id");let i;-1!==window.location.pathname.indexOf("exhibits/exhibit/")&&(i=r.exhibits.exhibit_unlock_record.post.endpoint.replace(":exhibit_id",a)),-1!==window.location.pathname.indexOf("items/heading")&&(t=helperModule.get_parameter_by_name("item_id"),e=r.exhibits.heading_unlock_record.post.endpoint.replace(":exhibit_id",a),i=e.replace(":heading_id",t)),window.location.pathname.indexOf("items/standard")&&(e=helperModule.get_parameter_by_name("item_id"),t=r.exhibits.item_unlock_record.post.endpoint.replace(":exhibit_id",a),i=t.replace(":item_id",e));r=authModule.get_user_token(),a=await httpModule.req({method:"POST",url:i,headers:{"Content-Type":"application/json","x-access-token":r}});void 0!==a&&200===a.status?window.location.reload():document.querySelector("#message").innerHTML='<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> An HTTP request error occurred unlocking record.</div>'},get_user_name:function(){return authModule.get_user_profile_data().name},get_owner:function(){var e=authModule.get_user_profile_data();return parseInt(e.uid)},check_bandwidth:function(r){let a=(new Date).getTime(),i,n=0;!async function e(){var t;200===(await httpModule.req({method:"GET",url:"https://upload.wikimedia.org/wikipedia/commons/9/90/ODJBcard.JPG"})).status&&(t=(new Date).getTime()-a,t=Number(55/(t/1e3)),i=((i||t)+t)/2,++n<10?(a=(new Date).getTime(),await e()):r(i.toFixed(0)))}()},check_app_env:function(){var e=window.location.hostname;"localhost"!==e&&"libwebapw01-vlt.du.edu"!==e&&"exhibits.dev"!==e||null!==(e=document.querySelector("#app-message"))&&(e.innerHTML='<div class="alert alert-danger"><i class="fa fa-exclamation-circle"></i> <strong>"STOP! Do not use Development Site"</strong>&nbsp;&nbsp;&nbsp;<a class="btn btn-info" href="https://exhibits-backend.library.du.edu/exhibits-dashboard/auth" target="_blank">Go to Live Site </a> </div>')},init:function(){}};return e})();helperModule.init();