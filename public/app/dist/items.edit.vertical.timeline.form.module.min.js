let itemsEditVerticalTimelineFormModule=(()=>{let d=window.localStorage.getItem("exhibits_app_path"),c=endpointsModule.get_exhibits_endpoints();var e={};let a={};async function o(){var e=await(async()=>{try{var e,t=helperModule.get_parameter_by_name("exhibit_id"),i=helperModule.get_parameter_by_name("item_id"),o=authModule.get_user_token(),l=c.exhibits.timeline_records.get.endpoint.replace(":exhibit_id",t).replace(":timeline_id",i);return!1===o?(document.querySelector("#message").innerHTML="ERROR: Unable to get API endpoints",setTimeout(()=>{window.location.replace(d+"/exhibits-dashboard/auth")},3e3),!1):void 0!==(e=await httpModule.req({method:"GET",url:l,headers:{"Content-Type":"application/json","x-access-token":o}}))&&200===e.status?e.data.data[0]:void 0}catch(e){document.querySelector("#message").innerHTML=`<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> ${e.message}</div>`}})(),t=e.created_by,i=new Date(e.created),o=e.updated_by,l=e.updated,l=new Date(l);let r="";var i=helperModule.format_date(i),l=helperModule.format_date(l),a=(null!==t&&(r+=`<em>Created by ${t} on ${i}</em>`),null!==o&&(r+=` | <em>Last updated by ${o} on ${l}</em>`),document.querySelector("#created").innerHTML=r,document.querySelector("#timeline-title-input").value=helperModule.unescape(e.title),document.querySelector("#timeline-text-input").value=helperModule.unescape(e.text),JSON.parse(e.styles));if(0!==Object.keys(a).length){void 0!==a.backgroundColor?(document.querySelector("#timeline-background-color").value=a.backgroundColor,document.querySelector("#timeline-background-color-picker").value=a.backgroundColor):document.querySelector("#timeline-background-color").value="",void 0!==a.color?(document.querySelector("#timeline-font-color").value=a.color,document.querySelector("#timeline-font-color-picker").value=a.color):document.querySelector("#timeline-font-color").value="";var n=document.querySelector("#timeline-font");for(let e=0;e<n.length;e++)n[e].value===a.fontFamily&&(document.querySelector("#timeline-font").value=a.fontFamily);void 0!==a.fontSize?document.querySelector("#timeline-font-size").value=a.fontSize.replace("px",""):document.querySelector("#timeline-font-size").value=""}return!1}return e.update_timeline_record=async function(){try{window.scrollTo(0,0);var e=helperModule.get_parameter_by_name("exhibit_id"),t=helperModule.get_parameter_by_name("item_id");if(void 0===e||void 0===t)return!(document.querySelector("#message").innerHTML='<div class="alert alert-warning" role="alert"><i class="fa fa-info"></i> Unable to update timeline record.</div>');document.querySelector("#message").innerHTML='<div class="alert alert-info" role="alert"><i class="fa fa-info"></i> Updating timeline record...</div>';var i=itemsCommonVerticalTimelineFormModule.get_common_timeline_form_fields(a);if(!1===i)return!1;i.updated_by=helperModule.get_user_name();var o=c.exhibits.timeline_records.put.endpoint.replace(":exhibit_id",e).replace(":timeline_id",t),l=authModule.get_user_token(),r=await httpModule.req({method:"PUT",url:o,data:i,headers:{"Content-Type":"application/json","x-access-token":l}});void 0!==r&&201===r.status&&(window.scrollTo(0,0),document.querySelector("#message").innerHTML='<div class="alert alert-success" role="alert"><i class="fa fa-info"></i> Timeline record updated</div>',r.data.data,setTimeout(()=>{window.location.reload()},900))}catch(e){document.querySelector("#message").innerHTML=`<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> ${e.message}</div>`}},e.init=async function(){var e=helperModule.get_parameter_by_name("exhibit_id"),t=helperModule.get_parameter_by_name("item_id"),i="/items/vertical-timeline/details?exhibit_id="+e+"&item_id="+t+"&status=403";console.log(e),console.log(t),console.log(i),exhibitsModule.set_exhibit_title(e),document.querySelector("#save-timeline-btn").addEventListener("click",itemsEditVerticalTimelineFormModule.update_timeline_record),await o()},e})();