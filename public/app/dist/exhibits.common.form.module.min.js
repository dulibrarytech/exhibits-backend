let exhibitsCommonFormModule=(()=>{let s=endpointsModule.get_exhibits_endpoints();var e={get_common_form_fields:function(){const e="#exhibit-title-input",t="#exhibit-sub-title-input",r="#exhibit-description-input",o="#exhibit-about-the-curators-input",n="#selected-subjects",a="#exhibit-alert-text-input",l="#is-featured",i="#is-student-curated",u="#is-content-advisory",c="#exhibit-owner",s="#is-published",d="#hero-image",m="#thumbnail-image",h="#exhibit-page-layout",p="#exhibit-template",f="#exhibit-title-error",H="#message";var g=(e,t="")=>document.querySelector(e)?.value?.trim()||t,b=e=>document.querySelector(e)?.checked??!1,v=e=>e?1:0,y=(e,t=null)=>null==e||""===e||(e=Number(e),isNaN(e))?t:e,_=(e,t)=>{var r,o,n=document.querySelector(e);n?((r=document.createElement("div")).className="alert alert-danger",r.setAttribute("role","alert"),(o=document.createElement("i")).className="fa fa-exclamation",t=document.createTextNode(" "+t),r.appendChild(o),r.appendChild(t),n.innerHTML="",n.appendChild(r)):console.error(`Error element ${e} not found`)};try{var E,w,x,k,M,T,N,S,C,q,A,L,P,j,z=helperModule.clean_html(g(e)),F=helperModule.clean_html(g(t)),R=helperModule.clean_html(g(r)),D=helperModule.clean_html(g(o));return z?(E=b(l),w=b(i),x=b(u)?helperModule.clean_html(g(a)):"",k=g(c),M=g(s),T=g(d),N=g(m),C=0<(S=document.getElementsByName("banner_template")).length?helperModule.get_checked_radio_button(S):"",q=g(h),A=g(p),L={title:z,subtitle:F,description:R,exhibit_subjects:g(n),about_the_curators:D,is_featured:v(E),is_student_curated:v(w),alert_text:x,hero_image:T,thumbnail:N,banner_template:C,page_layout:q,exhibit_template:A},k&&null!==(P=y(k,null))&&(L.owner=P),M&&null!==(j=y(M,null))&&(L.is_published=j),L):(_(f,"Please enter an exhibit title"),!1)}catch(e){return console.error("Error getting form fields:",e),_(H,"An error occurred while processing form data"),!1}}};return e.get_exhibit_styles=function(){var t,r,o,n=e=>{var t,r,o={};for([t,r]of Object.entries(e)){o[t]={};for(var[n,a]of Object.entries(r)){l=a.selector;var l=document.querySelector(l)?.value?.trim()||"";o[t][n]=(n=l,l=a.transform,n?l?l(n):n:"")}}return o};try{return{exhibit:n({navigation:{backgroundColor:{selector:"#nav-background-color",transform:null},color:{selector:"#nav-font-color",transform:null},fontFamily:{selector:"#nav-font",transform:null},fontSize:{selector:"#nav-font-size",transform:e=>e?e+"px":""}},template:{backgroundColor:{selector:"#template-background-color",transform:null},color:{selector:"#template-font-color",transform:null},fontFamily:{selector:"#template-font",transform:null},fontSize:{selector:"#template-font-size",transform:e=>e?e+"px":""}},introduction:{backgroundColor:{selector:"#introduction-background-color",transform:null},color:{selector:"#introduction-font-color",transform:null},fontFamily:{selector:"#introduction-font",transform:null},fontSize:{selector:"#introduction-font-size",transform:e=>e?e+"px":""}}})}}catch(e){return console.error("Error getting exhibit styles:",e),n="An error occurred while processing style data",(o=document.querySelector("#message"))?((t=document.createElement("div")).className="alert alert-danger",t.setAttribute("role","alert"),(r=document.createElement("i")).className="fa fa-exclamation",n=document.createTextNode(" "+n),t.appendChild(r),t.appendChild(n),o.innerHTML="",o.appendChild(t)):console.error("Message element not found"),null}},e.delete_hero_image=async function(){var t=(e,t="success",r="fa-info")=>{var o,n=document.querySelector("#message");n?((o=document.createElement("div")).className="alert alert-"+t,o.setAttribute("role","alert"),(t=document.createElement("i")).className="fa "+r,r=document.createTextNode(" "+e),o.appendChild(t),o.appendChild(r),n.innerHTML="",n.appendChild(o)):console.error("Message element not found")};let e=e=>{e=document.querySelector(e);e&&("INPUT"===e.tagName||"TEXTAREA"===e.tagName?e.value="":e.innerHTML="")};var r=()=>{e("#hero-image"),e("#hero-image-filename-display"),e("#hero-image-display"),((e,t)=>{e=document.querySelector(e);e&&(e.style.display=t)})("#hero-trash","none")};let o=null;try{if(!s||"object"!=typeof s)throw new Error("API endpoints configuration not available");var n=document.querySelector("#hero-image");if(!n)throw new Error("Hero image input element not found");var a=n.value?.trim();if(!a)return t("No hero image to delete","warning","fa-exclamation"),!1;var l=authModule.get_user_token();if(!l)return t("Authentication error: Please log in again","danger","fa-lock"),!1;var i=s.exhibits?.media?.delete?.endpoint;if(!i)throw new Error("Endpoint configuration not found");var u=i+"?"+(e=>{var t,r,o=new URLSearchParams;for([t,r]of Object.entries(e))null!=r&&o.append(t,r);return o.toString()})({media:a}),c=(t("Deleting hero image...","info"),await Promise.race([httpModule.req({method:"DELETE",url:u,headers:{"Content-Type":"application/json","x-access-token":l}}),new Promise((e,t)=>setTimeout(()=>t(new Error("Request timeout")),3e4))]));if(!c)throw new Error("No response received from server");if(204!==c.status)throw new Error("Failed to delete hero image. Server returned status "+c.status);return r(),t("Hero image deleted successfully","success","fa-check"),o=setTimeout(()=>{e("#message")},3e3),!0}catch(e){return o&&clearTimeout(o),console.error("Error deleting hero image:",e),t(e.message||"An unexpected error occurred while deleting the hero image","danger","fa-exclamation"),!1}},e.delete_thumbnail_image=async function(){var t=(e,t="success",r="fa-info")=>{var o,n=document.querySelector("#message");n?((o=document.createElement("div")).className="alert alert-"+t,o.setAttribute("role","alert"),(t=document.createElement("i")).className="fa "+r,r=document.createTextNode(" "+e),o.appendChild(t),o.appendChild(r),n.innerHTML="",n.appendChild(o)):console.error("Message element not found")};let e=e=>{e=document.querySelector(e);e&&("INPUT"===e.tagName||"TEXTAREA"===e.tagName?e.value="":e.innerHTML="")};var r=()=>{e("#thumbnail-image"),e("#thumbnail-filename-display"),e("#thumbnail-image-display"),((e,t)=>{e=document.querySelector(e);e&&(e.style.display=t)})("#thumbnail-trash","none")};let o=null;try{if(!s||"object"!=typeof s)throw new Error("API endpoints configuration not available");var n=document.querySelector("#thumbnail-image");if(!n)throw new Error("Thumbnail image input element not found");var a=n.value?.trim();if(!a)return t("No thumbnail image to delete","warning","fa-exclamation"),!1;var l=authModule.get_user_token();if(!l)return t("Authentication error: Please log in again","danger","fa-lock"),!1;var i=s.exhibits?.media?.delete?.endpoint;if(!i)throw new Error("Endpoint configuration not found");var u=i+"?"+(e=>{var t,r,o=new URLSearchParams;for([t,r]of Object.entries(e))null!=r&&o.append(t,r);return o.toString()})({media:a}),c=(t("Deleting thumbnail image...","info"),await Promise.race([httpModule.req({method:"DELETE",url:u,headers:{"Content-Type":"application/json","x-access-token":l}}),new Promise((e,t)=>setTimeout(()=>t(new Error("Request timeout")),3e4))]));if(!c)throw new Error("No response received from server");if(204!==c.status)throw new Error("Failed to delete thumbnail image. Server returned status "+c.status);return r(),t("Thumbnail image deleted successfully","success","fa-check"),o=setTimeout(()=>{e("#message")},3e3),!0}catch(e){return o&&clearTimeout(o),console.error("Error deleting thumbnail image:",e),t(e.message||"An unexpected error occurred while deleting the thumbnail image","danger","fa-exclamation"),!1}},e.init=async function(){var r=(e,t)=>{var r=document.querySelector(e);r?r.style.display=t:console.warn("Element not found: "+e)};let n=(e,t)=>{e&&t&&(t.value=e.value)};var t,o;try{uploadsModule?(uploadsModule.upload_exhibit_hero_image(),uploadsModule.upload_exhibit_thumbnail_image()):console.warn("uploadsModule not available");var a,l=authModule.get_user_token();if(!l)throw new Error("Authentication token not available");await authModule.check_auth(l),navModule&&"function"==typeof navModule.init&&navModule.init(),r("#hero-trash","none"),r("#thumbnail-trash","none");let e=0,t=0;for(a of[{input:"#introduction-background-color",picker:"#introduction-background-color-picker"},{input:"#introduction-font-color",picker:"#introduction-font-color-picker"},{input:"#nav-background-color",picker:"#nav-background-color-picker"},{input:"#nav-font-color",picker:"#nav-font-color-picker"},{input:"#template-background-color",picker:"#template-background-color-picker"},{input:"#template-font-color",picker:"#template-font-color-picker"}])((e,t)=>{let r=document.querySelector(e),o=document.querySelector(t);return r&&o?(o.addEventListener("input",()=>{n(o,r)}),r.addEventListener("input",()=>{n(r,o)}),!0):(console.warn(`Color picker elements not found: ${e} or `+t),!1)})(a.input,a.picker)?e++:t++;return console.log(`Color pickers initialized: ${e} synced, ${t} failed`),helperModule&&"function"==typeof helperModule.show_form&&helperModule.show_form(),console.log("Module initialized successfully"),!0}catch(e){console.error("Error initializing module:",e);var l=e.message||"An error occurred during initialization";return r=l,(l=document.querySelector("#message"))?((t=document.createElement("div")).className="alert alert-danger",t.setAttribute("role","alert"),(o=document.createElement("i")).className="fa fa-exclamation",r=document.createTextNode(" "+r),t.appendChild(o),t.appendChild(r),l.innerHTML="",l.appendChild(t)):console.error("Message element not found"),!1}},e})();