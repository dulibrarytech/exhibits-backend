let itemsEditGridItemFormModule=(()=>{let p=window.localStorage.getItem("exhibits_app_path"),g=endpointsModule.get_exhibits_endpoints();var e={};async function t(){try{var t=await(async()=>{try{var e,t=helperModule.get_parameter_by_name("exhibit_id"),a=helperModule.get_parameter_by_name("grid_id"),r=helperModule.get_parameter_by_name("item_id"),i=authModule.get_user_token(),o=authModule.get_user_profile_data(),l=g.exhibits.grid_item_record.get.endpoint.replace(":exhibit_id",t).replace(":grid_id",a).replace(":item_id",r);return!1===i?(document.querySelector("#message").innerHTML="ERROR: Unable to get API endpoints",setTimeout(()=>{window.location.replace(p+"/exhibits-dashboard/auth")},1e3),!1):void 0!==(e=await httpModule.req({method:"GET",url:l+"?type=edit&uid="+o.uid,headers:{"Content-Type":"application/json","x-access-token":i}}))&&200===e.status?e.data.data[0]:void 0}catch(e){document.querySelector("#message").innerHTML=`<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> ${e.message}</div>`}})(),a=t.is_published,r=t.created_by,i=new Date(t.created),o=t.updated_by,l=t.updated,d=new Date(l);let e="";var n=helperModule.format_date(i),c=helperModule.format_date(d),u=(helperModule.check_if_locked(t,"#item-submit-card"),null!==r&&(e+=`<em>Created by ${r} on ${n}</em>`),null!==o&&(e+=` | <em>Last updated by ${o} on ${c}</em>`),document.querySelector("#created").innerHTML=e,null!==document.querySelector("#is-published")&&1===a?document.querySelector("#is-published").value=!0:null!==document.querySelector("#is-published")&&0===a&&(document.querySelector("#is-published").value=!1),document.querySelector("#item-title-input").value=helperModule.unescape(t.title),document.querySelector("#item-text-input").value=helperModule.unescape(t.text),-1!==window.location.pathname.indexOf("media")&&await helperMediaModule.display_media_fields_common(t),document.getElementsByName("layout"));for(let e=0;e<u.length;e++)u[e].value===t.layout&&(document.querySelector("#"+u[e].id).checked=!0);var s=document.getElementsByName("media_width");for(let e=0;e<s.length;e++)parseInt(s[e].value)===parseInt(t.media_width)&&(document.querySelector("#"+s[e].id).checked=!0);var m=JSON.parse(t.styles);if(0!==Object.keys(m).length){void 0!==m.backgroundColor?(document.querySelector("#item-background-color").value=m.backgroundColor,document.querySelector("#item-background-color-picker").value=m.backgroundColor):document.querySelector("#item-background-color").value="",void 0!==m.color?(document.querySelector("#item-font-color").value=m.color,document.querySelector("#item-font-color-picker").value=m.color):document.querySelector("#item-font-color").value="";var _=document.querySelector("#item-font");for(let e=0;e<_.length;e++)_[e].value===m.fontFamily&&(document.querySelector("#item-font").value=m.fontFamily);void 0!==m.fontSize?document.querySelector("#item-font-size").value=m.fontSize.replace("px",""):document.querySelector("#item-font-size").value=""}return!1}catch(e){document.querySelector("#message").innerHTML=`<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> ${e.message}</div>`}}return e.update_grid_item_record=async function(){try{window.scrollTo(0,0);var e=helperModule.get_parameter_by_name("exhibit_id"),t=helperModule.get_parameter_by_name("grid_id"),a=helperModule.get_parameter_by_name("item_id");if(void 0===e||void 0===t||void 0===a)return!(document.querySelector("#message").innerHTML='<div class="alert alert-warning" role="alert"><i class="fa fa-info"></i> Unable to update grid item record.</div>');document.querySelector("#message").innerHTML='<div class="alert alert-info" role="alert"><i class="fa fa-info"></i> Updating grid item record...</div>';var r=itemsCommonGridItemFormModule.get_common_grid_item_form_fields();if(void 0===r)return!(document.querySelector("#message").innerHTML='<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> Unable to get form field values</div>');if(!1===r)return!1;var i=JSON.parse(sessionStorage.getItem("exhibits_user"));if(null===i.name)return!(document.querySelector("#message").innerHTML='<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> Unable to retrieve your name</div>');r.updated_by=i.name;var o=g.exhibits.grid_item_records.put.endpoint.replace(":exhibit_id",e).replace(":grid_id",t).replace(":item_id",a),l=authModule.get_user_token(),d=await httpModule.req({method:"PUT",url:o,data:r,headers:{"Content-Type":"application/json","x-access-token":l}});void 0!==d&&201===d.status&&(document.querySelector("#message").innerHTML='<div class="alert alert-success" role="alert"><i class="fa fa-info"></i> Grid item record updated</div>',setTimeout(()=>{window.location.reload()},900))}catch(e){document.querySelector("#message").innerHTML=`<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> ${e.message}</div>`}},e.init=async function(){try{var e=helperModule.get_parameter_by_name("exhibit_id");exhibitsModule.set_exhibit_title(e),navModule.back_to_grid_items(),await t(),document.querySelector("#save-item-btn").addEventListener("click",itemsEditGridItemFormModule.update_grid_item_record),-1!==window.location.pathname.indexOf("media")&&helperMediaModule.media_edit_init()}catch(e){document.querySelector("#message").innerHTML=`<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> ${e.message}</div>`}},e})();