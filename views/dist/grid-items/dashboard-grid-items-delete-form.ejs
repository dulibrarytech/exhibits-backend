<%- include('../partials/header.ejs'); %> <body> <%- include('../partials/nav.ejs'); %> <div id="right-panel" class="right-panel"> <%- include('../partials/main-header.ejs'); %> <div class="content" style="min-height: 875px;"><div id="message"></div><div id="delete-card" class="card"><div class="card-header"><strong class="card-title mb-3"></strong></div><div class="card-body"><div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> Are you sure you want to delete this grid item from the <strong><span id="exhibit-title"></span></strong> exhibit grid item?&nbsp;&nbsp; <button class="btn btn-danger" type="button" id="delete-item-btn"><i class="fa fa-trash"></i>&nbsp;&nbsp;<span id="delete-message">Delete</span></button></div></div></div></div><div class="clearfix"></div> <%- include('../partials/footer.ejs'); %> </div><!-- libs --> <%- include('../partials/exhibits-libs-common.ejs'); %> <!-- app --> <%- include('../partials/exhibits-app-common.ejs'); %> <script src="/exhibits-dashboard/static/app/dist/exhibits.module.min.js?<%=build_version%>"></script><script src="/exhibits-dashboard/static/app/dist/items.grid.module.min.js?<%=build_version%>"></script><script>(async function() {

        try {

            const status = helperModule.get_parameter_by_name('status');
            const exhibit_id = helperModule.get_parameter_by_name('exhibit_id');
            const grid_id = helperModule.get_parameter_by_name('grid_id');
            const item_id = helperModule.get_parameter_by_name('item_id');

            if (status !== null && status === '403') {

                document.querySelector('#message').innerHTML = `<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> You do not have permission to delete this item.</div>`;

                setTimeout(() => {
                    window.history.replaceState({page: 'items'}, '', '/exhibits-dashboard/items/grid/item/delete?exhibit_id=' + exhibit_id + '&grid_id=' + grid_id + '&item_id=' + item_id);
                }, 0);

            } else {

                const redirect = '/items/grid/item/delete?exhibit_id=' + exhibit_id + '&grid_id=' + grid_id + '&item_id=' + item_id + '&status=403';
                await authModule.check_permissions(['delete_item', 'delete_any_item'], 'item', exhibit_id, item_id, redirect);
                await exhibitsModule.set_exhibit_title(exhibit_id);
                document.querySelector('#delete-item-btn').addEventListener('click', itemsGridModule.delete_grid_item);
                helperModule.show_form();
            }

            navModule.set_item_list_link();

        } catch (error) {
            document.querySelector('#message').innerHTML = `<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> ${error.message}</div>`;
        }

    })();</script></body>