let itemsDetailsTimelineItemModule=(()=>{window.localStorage.getItem("exhibits_app_path");let _=endpointsModule.get_exhibits_endpoints();var e={};async function a(){let e=e=>e instanceof Date&&!isNaN(e.getTime());var t,a,r,i,n,d,o,l,c,m,s;try{var u,p=await(async()=>{var e,t,a,r=document.querySelector("#message"),i=(e,t,a)=>{var r,i;e&&(t=["info","success","danger","warning"].includes(t)?t:"danger",(r=document.createElement("div")).className="alert alert-"+t,r.setAttribute("role","alert"),(i=document.createElement("i")).className=(e=>{const t={info:"fa fa-info",success:"fa fa-check",danger:"fa fa-exclamation",warning:"fa fa-exclamation-triangle"};return t[e]||"fa fa-exclamation"})(t),r.appendChild(i),t=document.createTextNode(" "+a),r.appendChild(t),e.textContent="",e.appendChild(r))};try{var n=helperModule.get_parameter_by_name("exhibit_id"),d=helperModule.get_parameter_by_name("timeline_id"),o=helperModule.get_parameter_by_name("item_id"),l=(t=d,a=o,(e=n)&&t&&a?255<e.length||255<t.length||255<a.length?{valid:!1,error:"Invalid parameter length"}:{valid:!0}:{valid:!1,error:"Missing required parameters: exhibit_id, timeline_id, or item_id"});if(!l.valid)return i(r,"danger",l.error),null;var c=authModule.get_user_token();if(!c||!1===c)return i(r,"danger","Authentication required. Redirecting..."),setTimeout(()=>{authModule.redirect_to_auth()},1e3),null;if(!_?.exhibits?.timeline_item_record?.get?.endpoint)return i(r,"danger","API endpoint configuration missing"),null;var m=_.exhibits.timeline_item_record.get.endpoint.replace(":exhibit_id",encodeURIComponent(n)).replace(":timeline_id",encodeURIComponent(d)).replace(":item_id",encodeURIComponent(o)),s=await httpModule.req({method:"GET",url:m,headers:{"Content-Type":"application/json","x-access-token":c},timeout:3e4});if(!s)throw new Error("No response received from server");if(200!==s.status)throw new Error("Server returned status "+s.status);if(s.data?.data)return s.data.data;throw new Error("Invalid response structure")}catch(e){return console.error("Error in get_timeline_item_record:",e),i(r,"danger",e.user_message||"Unable to load the timeline item record. Please try again."),null}})();if(p)return u={created:document.querySelector("#created"),item_title:document.querySelector("#item-title-input"),item_text:document.querySelector("#item-text-input"),item_date:document.querySelector("#item-date-input")},o=p,(l=u.created)&&o&&(c=[],o.created_by&&o.created&&(s=new Date(o.created),e(s))&&(s=helperModule.format_date(s),(m=document.createElement("em")).textContent=`Created by ${o.created_by} on `+s,c.push(m)),o.updated_by&&o.updated&&(s=new Date(o.updated),e(s))&&(m=helperModule.format_date(s),(s=document.createElement("em")).textContent=`Last updated by ${o.updated_by} on `+m,c.push(s)),l.textContent="",c.forEach((e,t)=>{0<t&&l.appendChild(document.createTextNode(" | ")),l.appendChild(e)})),n=p.title,(d=u.item_title)&&(n=n?helperModule.unescape(n):"",d.value=n),r=p.text,(i=u.item_text)&&(r=r?helperModule.unescape(r):"",i.value=r),t=p.date,(a=u.item_date)&&(t&&0<(t=String(t).split("T")).length&&t[0]?a.value=t[0]:a.value=""),await(async e=>{if(-1!==window.location.pathname.indexOf("media")&&"function"==typeof helperMediaModule?.display_media_fields_common)try{await helperMediaModule.display_media_fields_common(e)}catch(e){console.error("Error displaying media fields:",e)}})(p),!1;throw new Error("Failed to load timeline item record data")}catch(e){return console.error("Error in display_details_record:",e),o="Unable to display the timeline item record. Please try again.",(m=document.querySelector("#message"))&&((s=document.createElement("div")).className="alert alert-danger",s.setAttribute("role","alert"),(c=document.createElement("i")).className="fa fa-exclamation",s.appendChild(c),c=document.createTextNode(" "+o),s.appendChild(c),m.textContent="",m.appendChild(s)),!1}}return e.init=async function(){try{var e=helperModule.get_parameter_by_name("status"),t=(null!==e&&"403"===e&&(document.querySelector("#message").innerHTML='<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> You do not have permission to edit this record.</div>'),helperModule.get_parameter_by_name("exhibit_id"));exhibitsModule.set_exhibit_title(t),navModule.set_timeline_item_nav_menu_links(),await a(),-1!==window.location.pathname.indexOf("media")&&helperMediaModule.media_edit_init()}catch(e){document.querySelector("#message").innerHTML=`<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> ${e.message}</div>`}},e})();