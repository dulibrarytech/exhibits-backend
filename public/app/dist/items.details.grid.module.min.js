let itemsDetailsGridFormModule=(()=>{window.localStorage.getItem("exhibits_app_path");let m=endpointsModule.get_exhibits_endpoints();var e={};async function t(){let e=e=>e instanceof Date&&!isNaN(e.getTime());var t,r,a,n,d,i,o,l,c;try{var u,s=await(async()=>{var e,t,r=document.querySelector("#message"),a=(e,t,r)=>{var a,n;e&&(t=["info","success","danger","warning"].includes(t)?t:"danger",(a=document.createElement("div")).className="alert alert-"+t,a.setAttribute("role","alert"),(n=document.createElement("i")).className=(e=>{const t={info:"fa fa-info",success:"fa fa-check",danger:"fa fa-exclamation",warning:"fa fa-exclamation-triangle"};return t[e]||"fa fa-exclamation"})(t),a.appendChild(n),t=document.createTextNode(" "+r),a.appendChild(t),e.textContent="",e.appendChild(a))};try{var n=helperModule.get_parameter_by_name("exhibit_id"),d=helperModule.get_parameter_by_name("item_id"),i=(t=d,(e=n)&&t?255<e.length||255<t.length?{valid:!1,error:"Invalid parameter length"}:{valid:!0}:{valid:!1,error:"Missing required parameters: exhibit_id or grid_id"});if(!i.valid)return a(r,"danger",i.error),null;var o=authModule.get_user_token();if(!o||!1===o)return a(r,"danger","Authentication required. Redirecting..."),setTimeout(()=>{authModule.redirect_to_auth()},1e3),null;if(!m?.exhibits?.grid_records?.get?.endpoint)return a(r,"danger","API endpoint configuration missing"),null;var l=m.exhibits.grid_records.get.endpoint.replace(":exhibit_id",encodeURIComponent(n)).replace(":grid_id",encodeURIComponent(d)),c=await httpModule.req({method:"GET",url:l,headers:{"Content-Type":"application/json","x-access-token":o},timeout:3e4});if(!c)throw new Error("No response received from server");if(200!==c.status)throw new Error("Server returned status "+c.status);if(c.data?.data)return console.log(c.data.data),c.data.data;throw new Error("Invalid response structure")}catch(e){return console.error("Error in get_grid_record:",e),a(r,"danger",e.user_message||"Unable to load the grid record. Please try again."),null}})();if(s)return u={created:document.querySelector("#created"),grid_title:document.querySelector("#grid-title-input"),grid_text:document.querySelector("#grid-text-input"),grid_columns:document.querySelector("#grid-columns")},d=s,(i=u.created)&&d&&(o=[],d.created_by&&d.created&&(c=new Date(d.created),e(c))&&(c=helperModule.format_date(c),(l=document.createElement("em")).textContent=`Created by ${d.created_by} on `+c,o.push(l)),d.updated_by&&d.updated&&(c=new Date(d.updated),e(c))&&(l=helperModule.format_date(c),(c=document.createElement("em")).textContent=`Last updated by ${d.updated_by} on `+l,o.push(c)),i.textContent="",o.forEach((e,t)=>{0<t&&i.appendChild(document.createTextNode(" | ")),i.appendChild(e)})),a=s.title,(n=u.grid_title)&&(a=a?helperModule.unescape(a):"",n.value=a),t=s.text,(r=u.grid_text)&&(t=t?helperModule.unescape(t):"",r.value=t),((t,r)=>{if(r){let e=parseInt(t,10);(isNaN(e)||e<1||12<e)&&(e=3),r.value=e}})(s.columns,u.grid_columns),!1;throw new Error("Failed to load grid record data")}catch(e){return console.error("Error in display_details_record:",e),d="Unable to display the grid record. Please try again.",(l=document.querySelector("#message"))&&((c=document.createElement("div")).className="alert alert-danger",c.setAttribute("role","alert"),(o=document.createElement("i")).className="fa fa-exclamation",c.appendChild(o),o=document.createTextNode(" "+d),c.appendChild(o),l.textContent="",l.appendChild(c)),!1}}return e.init=async function(){var e=helperModule.get_parameter_by_name("status"),e=(null!==e&&"403"===e&&(document.querySelector("#message").innerHTML='<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> You do not have permission to edit this record.</div>'),helperModule.get_parameter_by_name("exhibit_id"));exhibitsModule.set_exhibit_title(e),await t()},e})();