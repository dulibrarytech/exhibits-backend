let itemsAddVerticalTimelineFormModule=(()=>{let l=endpointsModule.get_exhibits_endpoints();var e={create_timeline_record:async function(){try{window.scrollTo(0,0);let i=helperModule.get_parameter_by_name("exhibit_id");if(void 0===i)return!(document.querySelector("#message").innerHTML='<div class="alert alert-warning" role="alert"><i class="fa fa-info"></i> Unable to create timeline record.</div>');document.querySelector("#message").innerHTML='<div class="alert alert-info" role="alert"><i class="fa fa-info"></i> Creating timeline record...</div>';var e=itemsCommonVerticalTimelineFormModule.get_common_timeline_form_fields();if(!1===e)return!1;var t=JSON.parse(sessionStorage.getItem("exhibits_user"));if(null===t.name)return!(document.querySelector("#message").innerHTML='<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> Unable to retrieve your name</div>');e.created_by=t.name;var a=authModule.get_user_token(),r=await httpModule.req({method:"POST",url:l.exhibits.timeline_records.post.endpoint.replace(":exhibit_id",i),data:e,headers:{"Content-Type":"application/json","x-access-token":a}});if(void 0!==r&&201===r.status){window.scrollTo(0,0),document.querySelector("#message").innerHTML='<div class="alert alert-success" role="alert"><i class="fa fa-info"></i> Timeline record created</div>';let e=r.data.data;console.log(e),setTimeout(()=>{window.location.replace(`/exhibits-dashboard/items/vertical-timeline/edit?exhibit_id=${i}&item_id=`+e)},900)}else void 0===r&&(document.querySelector("#message").innerHTML='<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> You do not have permission to add item to this exhibit.</div>')}catch(e){document.querySelector("#message").innerHTML=`<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> ${e.message}</div>`}},init:async function(){try{var e=helperModule.get_parameter_by_name("exhibit_id"),i="/items?exhibit_id="+e+"&status=403";await authModule.check_permissions(["add_item","add_item_to_any_exhibit"],"grid",e,i),exhibitsModule.set_exhibit_title(e),document.querySelector("#save-timeline-btn").addEventListener("click",itemsAddVerticalTimelineFormModule.create_timeline_record)}catch(e){document.querySelector("#message").innerHTML=`<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> ${e.message}</div>`}}};return e})();