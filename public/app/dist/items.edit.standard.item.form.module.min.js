let itemsEditStandardItemFormModule=(()=>{let s=window.localStorage.getItem("exhibits_app_path");var e={};async function o(){var t=await(async()=>{try{var e,t=endpointsModule.get_exhibits_endpoints(),a=helperModule.get_parameter_by_name("exhibit_id"),r=helperModule.get_parameter_by_name("item_id"),o=authModule.get_user_token(),i=authModule.get_user_profile_data(),l=t.exhibits.item_records.get.endpoint.replace(":exhibit_id",a).replace(":item_id",r);return!1===o?(document.querySelector("#message").innerHTML="ERROR: Unable to get API endpoints",setTimeout(()=>{window.location.replace(s+"/exhibits-dashboard/auth")},1e3),!1):void 0!==(e=await httpModule.req({method:"GET",url:l+"?type=edit&uid="+i.uid,headers:{"Content-Type":"application/json","x-access-token":o}}))&&200===e.status?e.data.data[0]:void 0}catch(e){document.querySelector("#message").innerHTML=`<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> ${e.message}</div>`}})(),e=t.is_published,a=t.created_by,r=new Date(t.created),o=t.updated_by,i=t.updated,i=new Date(i);let l="";var r=helperModule.format_date(r),i=helperModule.format_date(i),d=(helperModule.check_if_locked(t,"#exhibit-submit-card"),null!==a&&(l+=`<em>Created by ${a} on ${r}</em>`),null!==o&&(l+=` | <em>Last updated by ${o} on ${i}</em>`),document.querySelector("#created").innerHTML=l,null!==document.querySelector("#is-published")&&1===e?document.querySelector("#is-published").value=!0:null!==document.querySelector("#is-published")&&0===e&&(document.querySelector("#is-published").value=!1),document.querySelector("#item-title-input").value=helperModule.unescape(t.title),document.querySelector("#item-text-input").value=helperModule.unescape(t.text),-1!==window.location.pathname.indexOf("media")&&(await helperMediaModule.display_media_fields_common(t),a=t.item_subjects.split("|"),await helperModule.create_subjects_menu(a)),document.getElementsByName("layout"));for(let e=0;e<d.length;e++)d[e].value===t.layout&&(document.querySelector("#"+d[e].id).checked=!0);var n=document.getElementsByName("media_width");for(let e=0;e<n.length;e++)parseInt(n[e].value)===parseInt(t.media_width)&&(document.querySelector("#"+n[e].id).checked=!0);var u=JSON.parse(t.styles);if(0!==Object.keys(u).length){void 0!==u.backgroundColor?(document.querySelector("#item-background-color").value=u.backgroundColor,document.querySelector("#item-background-color-picker").value=u.backgroundColor):document.querySelector("#item-background-color").value="",void 0!==u.color?(document.querySelector("#item-font-color").value=u.color,document.querySelector("#item-font-color-picker").value=u.color):document.querySelector("#item-font-color").value="";var c=document.querySelector("#item-font");for(let e=0;e<c.length;e++)c[e].value===u.fontFamily&&(document.querySelector("#item-font").value=u.fontFamily);void 0!==u.fontSize?document.querySelector("#item-font-size").value=u.fontSize.replace("px",""):document.querySelector("#item-font-size").value=""}return!1}return e.update_item_record=async function(){try{scrollTo(0,0);var e=endpointsModule.get_exhibits_endpoints(),t=helperModule.get_parameter_by_name("exhibit_id"),a=helperModule.get_parameter_by_name("item_id"),r=itemsCommonStandardItemFormModule.get_common_standard_item_form_fields(),o=authModule.get_user_token();if(void 0===t||void 0===a)return!(document.querySelector("#message").innerHTML='<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> Unable to get record ID</div>');if(!1===o)return setTimeout(()=>{document.querySelector("#message").innerHTML='<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> Unable to get session token</div>',authModule.logout()},1e3),!1;if(void 0===r)return!(document.querySelector("#message").innerHTML='<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> Unable to get form field values</div>');if(!1===r)return!1;r.updated_by=helperModule.get_user_name(),document.querySelector("#message").innerHTML='<div class="alert alert-info" role="alert"><i class="fa fa-info"></i> Updating item record...</div>';var i,l=e.exhibits.item_records.put.endpoint.replace(":exhibit_id",t).replace(":item_id",a);void 0!==(i=await httpModule.req({method:"PUT",url:l,data:r,headers:{"Content-Type":"application/json","x-access-token":o}}))&&201===i.status&&(document.querySelector("#message").innerHTML='<div class="alert alert-success" role="alert"><i class="fa fa-info"></i> Item record updated</div>',setTimeout(()=>{window.location.reload()},900))}catch(e){document.querySelector("#message").innerHTML=`<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> ${e.message}</div>`}},e.init=async function(){try{var t=helperModule.get_parameter_by_name("exhibit_id"),a=helperModule.get_parameter_by_name("item_id");let e="media";var r="/items/standard/"+(e=window.location.pathname.indexOf("text")?"text":e)+"/details?exhibit_id="+t+"&item_id="+a+"&status=403";await authModule.check_permissions(["update_item","update_any_item"],"item",t,a,r),exhibitsModule.set_exhibit_title(t),await o(),document.querySelector("#update-item-btn").addEventListener("click",itemsEditStandardItemFormModule.update_item_record),-1!==window.location.pathname.indexOf("media")&&helperMediaModule.media_edit_init()}catch(e){document.querySelector("#message").innerHTML=`<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> ${e.message}</div>`}},e})();