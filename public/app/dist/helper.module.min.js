let helperModule=(()=>{var e={get_parameter_by_name:function(e,t){try{t=t||window.location.href,e=e.replace(/[\[\]]/g,"\\$&");var a=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return a?a[2]?decodeURIComponent(DOMPurify.sanitize(a[2].replace(/\+/g," "))):"":null}catch(e){document.querySelector("#message").innerHTML=`<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> ${e.message}</div>`}},unescape:function(e){try{var t=document.createElement("textarea");return t.innerHTML=e,t.value}catch(e){document.querySelector("#message").innerHTML=`<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> ${e.message}</div>`}},strip_html:function(e){try{return e.replace(/(<([^>]+)>)/gi,"")}catch(e){document.querySelector("#message").innerHTML=`<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> ${e.message}</div>`}},clean_html:function(e){try{var t=document.createElement("div"),a=(t.innerHTML=e,["script","iframe","html","head","body","head","title","img","embed","applet","object","style","link","form","input","video","source","math","maction","picture","map","svg","details","frameset","comment","base"]);for(let e=0;e<a.length;e++)for(var r=t.getElementsByTagName(a[e]);r[0];)r[0].parentNode.removeChild(r[0]);return t.innerHTML.replace(/&amp;/g,"&")}catch(e){document.querySelector("#message").innerHTML=`<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> ${e.message}</div>`}},preview_html:function(e){try{var t=helperModule.clean_html(document.querySelector("#"+e).value);return document.querySelector("#preview-html").innerHTML=t,document.querySelector("#"+e).value=t,!1}catch(e){document.querySelector("#message").innerHTML=`<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> ${e.message}</div>`}},get_checked_radio_button:function(t){try{for(let e=0;e<t.length;e++)if(t[e].checked)return t[e].value}catch(e){document.querySelector("#message").innerHTML=`<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> ${e.message}</div>`}},get_current_year:function(){try{var e=(new Date).getFullYear();domModule.html("#cdate",DOMPurify.sanitize(e))}catch(e){document.querySelector("#message").innerHTML=`<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> ${e.message}</div>`}},format_date:function(e){return(1+e.getMonth()).toString().padStart(2,"0")+`/${e.getDate().toString().padStart(2,"0")}/${e.getFullYear()} @ ${e.getHours().toString().padStart(2,"0")}:${e.getMinutes().toString().padStart(2,"0")}:`+e.getSeconds().toString().padStart(2,"0")},get_repo_item_data:async function(e){try{var a=endpointsModule.get_exhibits_endpoints();let t=!0;null===e&&(e=document.querySelector("#repo-uuid").value,helperModule.clear_media_fields("repo_media"),t=!1),0===e.length&&(document.querySelector("#message").innerHTML='<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> Please enter a Repository UUID</div>');var r=authModule.get_user_token(),i=await httpModule.req({method:"GET",url:a.exhibits.repo_items.endpoint.replace(":uuid",e),headers:{"Content-Type":"application/json","x-access-token":r}});if(void 0!==i&&200===i.status){if(1===i.data.data.is_compound)return!(document.querySelector("#repo-item-metadata").innerHTML='<p style="color:red">Repository compound objects are not supported.</p>');var l=i.data.data.mime_type;let e;var o,n=document.querySelector("#tn"),d=document.querySelector("#item-mime-type"),c=document.querySelector("#item-type"),s=document.querySelector("#repo-item-metadata"),u=document.querySelector("#is-repo-item");return null!==n&&(o=helperModule.render_repo_thumbnail(i.data.data.thumbnail.data),n.innerHTML=`<img src="${o}" alt="thumbnail" height="200" width="200">`),null!==d&&(d.value=l),-1!==l.indexOf("image")?(e="image",null!==document.querySelector("#image-alt-text")&&(document.querySelector("#image-alt-text").style.display="block")):e=-1!==l.indexOf("video")?"video":-1!==l.indexOf("audio")?"audio":-1!==l.indexOf("pdf")?"pdf":"Unable to Determine Type",null!==c&&(c.value=e),null!==s&&(s.innerHTML=`<p><strong>${i.data.data.title}</strong><br><em>${l}</em></p>`),null!==u&&(u.value=1),!0===t?i.data.data:void 0}document.querySelector("#repo-item-metadata").innerHTML='<p style="color:red">Metadata record not found in repository.</p>'}catch(e){document.querySelector("#message").innerHTML=`<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> ${e.message}</div>`}},render_repo_thumbnail:function(e){try{var t=new Uint8Array(e),a=new Blob([t],{type:"image/jpeg"});return(window.URL||window.webkitURL).createObjectURL(a)}catch(e){document.querySelector("#message").innerHTML=`<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> ${e.message}</div>`}},clear_media_fields:function(e){"uploaded_media"===e&&(document.querySelector("#repo-uuid").value="",document.querySelector("#audio-video").value="",document.querySelector("#is-kaltura-item").value=0,document.querySelector("#is-repo-item").value=0),"repo_media"===e&&(document.querySelector("#audio-video").value="",document.querySelector("#is-kaltura-item").value=0),"kaltura_media"===e&&(document.querySelector("#repo-uuid").value="",document.querySelector("#is-repo-item").value=0),document.querySelector("#item-type").value="",document.querySelector("#item-mime-type").value="",document.querySelector("#item-media").value="",document.querySelector("#item-media-thumbnail-image-display").innerHTML="",document.querySelector("#item-media-filename-display").innerHTML="",document.querySelector("#item-media-trash").style.display="none"},show_form:function(){try{let e=Array.from(document.getElementsByClassName("card"));setTimeout(()=>{e.forEach(e=>{e.style.visibility="visible"})},500)}catch(e){document.querySelector("#message").innerHTML=`<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> ${e.message}</div>`}},toggle_alt_text:function(){try{var e=document.querySelector("#item-alt-text-input"),t=e.disabled;return!1===t?e.disabled=!0:!0===t&&(e.disabled=!1),!1}catch(e){document.querySelector("#message").innerHTML=`<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> ${e.message}</div>`}},set_alt_text:function(e){document.querySelector("#image-alt-text").style.display="block",1===e.is_alt_text_decorative?(document.querySelector("#is-alt-text-decorative").checked=!0,document.querySelector("#item-alt-text-input").disabled=!0):(document.querySelector("#is-alt-text-decorative").checked=!1,document.querySelector("#item-alt-text-input").value=helperModule.unescape(e.alt_text))},reorder_exhibits:async function(e,r){try{var t=endpointsModule.get_exhibits_endpoints(),i=helperModule.get_parameter_by_name("exhibit_id");let a={};var l=[];for(let e=0,t=r.length;e<t;e++){var o=r[e].node.getAttribute("id").split("_");a.type=o.pop(),a.uuid=o.pop(),a.order=r[e].node.childNodes[0].childNodes[1].innerText,l.push(a),a={}}var n=authModule.get_user_token(),d=await httpModule.req({method:"POST",url:t.exhibits.reorder_exhibits_records.post.endpoint.replace(":exhibit_id",i),data:l,headers:{"Content-Type":"application/json","x-access-token":n}});void 0!==d&&201===d.status?console.log(d):document.querySelector("#message").innerHTML='<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> An HTTP request error occurred while reordering items.</div>'}catch(e){document.querySelector("#message").innerHTML=`<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> ${e.message}</div>`}},reorder_items:async function(e,r){try{if(0===r.length)return!1;var t=endpointsModule.get_exhibits_endpoints(),i=helperModule.get_parameter_by_name("exhibit_id"),l=helperModule.get_parameter_by_name("grid_id");let a={};var o=[];for(let e=0,t=r.length;e<t;e++){var n=r[e].node.getAttribute("id").split("_");a.type=n.pop(),a.uuid=n.pop(),a.order=r[e].node.childNodes[0].childNodes[1].innerText,null!==l&&(a.grid_id=l),o.push(a),a={}}var d=authModule.get_user_token(),c=await httpModule.req({method:"POST",url:t.exhibits.reorder_records.post.endpoint.replace(":exhibit_id",i),data:o,headers:{"Content-Type":"application/json","x-access-token":d}});void 0!==c&&201===c.status?console.log(c):document.querySelector("#message").innerHTML='<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> An HTTP request error occurred while reordering items.</div>'}catch(e){document.querySelector("#message").innerHTML=`<div class="alert alert-danger" role="alert"><i class="fa fa-exclamation"></i> ${e.message}</div>`}},check_if_locked:function(e,t){var a=authModule.get_user_profile_data();1===e.is_locked&&e.locked_by_user!==parseInt(a.uid)&&(document.querySelector(t).style.display="none",null!==document.querySelector("#message"))&&(document.querySelector("#message").innerHTML='<div class="alert alert-warning" role="alert"><i class="fa fa-lock"></i> This record is currently being worked on by another user.</div>')},check_bandwidth:function(a){let r=(new Date).getTime(),i,l=0;!async function e(){var t;200===(await httpModule.req({method:"GET",url:"https://upload.wikimedia.org/wikipedia/commons/9/90/ODJBcard.JPG"})).status&&(t=(new Date).getTime()-r,t=Number(55/(t/1e3)),i=((i||t)+t)/2,++l<10?(r=(new Date).getTime(),await e()):a(i.toFixed(0)))}()},check_app_env:function(){var e=window.location.hostname;"localhost"!==e&&"libwebapw01-vlt.du.edu"!==e&&"exhibits.dev"!==e||null!==(e=document.querySelector("#app-message"))&&(e.innerHTML='<div class="alert alert-danger"><i class="fa fa-exclamation-circle"></i> <strong>"STOP! Do not use Development Site"</strong>&nbsp;&nbsp;&nbsp;<a class="btn btn-info" href="https://exhibits-backend.library.du.edu/exhibits-dashboard/auth" target="_blank">Go to Live Site </a> </div>')},init:function(){}};return e})();helperModule.init();